{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/hooks/useGitActivity.ts"],"sourcesContent":["/**\n * useGitActivity Hook\n * \n * Custom React hook for managing Git activity data, including loading states,\n * caching, error handling, and real-time updates.\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport gitActivityService from '../services/gitActivityService';\nimport {\n  ActivityHeatmapData,\n  GitActivityMetrics,\n  GitActivityRequest,\n  GitActivityResponse,\n  UseGitActivityHeatmapReturn,\n  GitActivityError\n} from '../types/git-activity';\n\n/**\n * Hook for fetching and managing Git activity heatmap data\n */\nexport const useGitActivityHeatmap = (\n  owner: string,\n  repo: string,\n  options: {\n    provider?: 'github' | 'gitlab';\n    daysBack?: number;\n    useCache?: boolean;\n    forceRefresh?: boolean;\n    refreshInterval?: number;\n    enabled?: boolean;\n  } = {}\n): UseGitActivityHeatmapReturn => {\n  const {\n    provider = 'github',\n    daysBack = 365,\n    useCache = true,\n    forceRefresh = false,\n    refreshInterval = 0, // 0 = no auto refresh\n    enabled = true\n  } = options;\n\n  const queryClient = useQueryClient();\n  const [error, setError] = useState<string | null>(null);\n\n  // Query key for caching\n  const queryKey = ['git-activity', owner, repo, provider, daysBack];\n\n  // Main data fetching query\n  const {\n    data: response,\n    isLoading,\n    error: queryError,\n    refetch: queryRefetch\n  } = useQuery<GitActivityResponse, GitActivityError>({\n    queryKey,\n    queryFn: async () => {\n      setError(null);\n      \n      const request: GitActivityRequest = {\n        owner,\n        repo,\n        provider,\n        days_back: daysBack,\n        use_cache: useCache,\n        force_refresh: forceRefresh\n      };\n\n      try {\n        return await gitActivityService.getRepositoryActivity(request);\n      } catch (err) {\n        const gitError = err as GitActivityError;\n        setError(gitError.message);\n        throw gitError;\n      }\n    },\n    enabled: enabled && !!owner && !!repo,\n    staleTime: useCache ? 5 * 60 * 1000 : 0, // 5 minutes if using cache\n    refetchInterval: refreshInterval > 0 ? refreshInterval : false,\n    retry: (failureCount, error) => {\n      // Retry network errors but not auth/validation errors\n      const gitError = error as GitActivityError;\n      if (gitError.type === 'auth' || gitError.type === 'validation') {\n        return false;\n      }\n      return failureCount < 3;\n    }\n  });\n\n  // Extract heatmap data and metrics\n  const data: ActivityHeatmapData[] = response?.activity_heatmap || [];\n  const metrics: GitActivityMetrics | null = response ? {\n    total_commits: response.total_commits,\n    total_prs: response.total_prs,\n    total_contributors: response.total_contributors,\n    active_branches: response.active_branches,\n    lines_of_code: response.lines_of_code,\n    code_churn: response.code_churn,\n    avg_commits_per_day: response.avg_commits_per_day,\n    avg_pr_size: response.avg_pr_size,\n    top_contributors: response.top_contributors,\n    activity_heatmap: response.activity_heatmap,\n    velocity_trend: response.velocity_trend,\n    language_distribution: response.language_distribution\n  } : null;\n\n  // Refetch function\n  const refetch = useCallback(async () => {\n    try {\n      setError(null);\n      await queryRefetch();\n    } catch (err) {\n      const gitError = err as GitActivityError;\n      setError(gitError.message);\n    }\n  }, [queryRefetch]);\n\n  // Cache invalidation function\n  const invalidateCache = useCallback(async () => {\n    try {\n      await gitActivityService.invalidateCache(owner, repo);\n      await queryClient.invalidateQueries({ queryKey });\n      await refetch();\n    } catch (err) {\n      const gitError = err as GitActivityError;\n      setError(gitError.message);\n    }\n  }, [owner, repo, queryClient, queryKey, refetch]);\n\n  // Handle query errors\n  useEffect(() => {\n    if (queryError) {\n      const gitError = queryError as GitActivityError;\n      setError(gitError.message);\n    }\n  }, [queryError]);\n\n  return {\n    data,\n    metrics,\n    loading: isLoading,\n    error: error || (queryError as GitActivityError)?.message || null,\n    refetch,\n    invalidateCache\n  };\n};\n\n/**\n * Hook for fetching repository heatmap data only\n */\nexport const useRepositoryHeatmap = (\n  owner: string,\n  repo: string,\n  daysBack: number = 365,\n  options: {\n    enabled?: boolean;\n    refreshInterval?: number;\n  } = {}\n) => {\n  const { enabled = true, refreshInterval = 0 } = options;\n\n  return useQuery<ActivityHeatmapData[], GitActivityError>({\n    queryKey: ['git-heatmap', owner, repo, daysBack],\n    queryFn: () => gitActivityService.getRepositoryHeatmap(owner, repo, daysBack),\n    enabled: enabled && !!owner && !!repo,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    refetchInterval: refreshInterval > 0 ? refreshInterval : false\n  });\n};\n\n/**\n * Hook for managing multiple repositories\n */\nexport const useMultiRepositoryActivity = (\n  repositories: Array<{ owner: string; repo: string; provider?: 'github' | 'gitlab' }>,\n  options: {\n    daysBack?: number;\n    enabled?: boolean;\n  } = {}\n) => {\n  const { daysBack = 365, enabled = true } = options;\n  const [loading, setLoading] = useState(false);\n  const [data, setData] = useState<Record<string, ActivityHeatmapData[]>>({});\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  const fetchAllRepositories = useCallback(async () => {\n    if (!enabled || repositories.length === 0) return;\n\n    setLoading(true);\n    const results: Record<string, ActivityHeatmapData[]> = {};\n    const newErrors: Record<string, string> = {};\n\n    // Fetch all repositories in parallel\n    const promises = repositories.map(async ({ owner, repo, provider = 'github' }) => {\n      const key = `${owner}/${repo}`;\n      try {\n        const heatmapData = await gitActivityService.getRepositoryHeatmap(owner, repo, daysBack);\n        results[key] = heatmapData;\n      } catch (error) {\n        const gitError = error as GitActivityError;\n        newErrors[key] = gitError.message;\n      }\n    });\n\n    await Promise.allSettled(promises);\n\n    setData(results);\n    setErrors(newErrors);\n    setLoading(false);\n  }, [repositories, daysBack, enabled]);\n\n  useEffect(() => {\n    fetchAllRepositories();\n  }, [fetchAllRepositories]);\n\n  return {\n    data,\n    loading,\n    errors,\n    refetch: fetchAllRepositories\n  };\n};\n\n/**\n * Hook for real-time activity updates via WebSocket\n */\nexport const useRealTimeGitActivity = (\n  owner: string,\n  repo: string,\n  options: {\n    enabled?: boolean;\n    onUpdate?: (data: ActivityHeatmapData) => void;\n  } = {}\n) => {\n  const { enabled = true, onUpdate } = options;\n  const [isConnected, setIsConnected] = useState(false);\n  const [lastUpdate, setLastUpdate] = useState<Date | null>(null);\n  const wsRef = useRef<WebSocket | null>(null);\n  const queryClient = useQueryClient();\n\n  // WebSocket connection\n  useEffect(() => {\n    if (!enabled || !owner || !repo) return;\n\n    const wsUrl = `${process.env.NEXT_PUBLIC_WS_URL || 'ws://localhost:8000'}/ws/git-activity/${owner}/${repo}`;\n    \n    const connect = () => {\n      try {\n        wsRef.current = new WebSocket(wsUrl);\n\n        wsRef.current.onopen = () => {\n          setIsConnected(true);\n          console.log(`Connected to Git activity WebSocket for ${owner}/${repo}`);\n        };\n\n        wsRef.current.onmessage = (event) => {\n          try {\n            const data = JSON.parse(event.data) as ActivityHeatmapData;\n            setLastUpdate(new Date());\n            \n            // Update query cache\n            queryClient.setQueryData(\n              ['git-activity', owner, repo, 'github', 365],\n              (oldData: GitActivityResponse | undefined) => {\n                if (!oldData) return oldData;\n                \n                // Update the activity heatmap data\n                const updatedHeatmap = [...oldData.activity_heatmap];\n                const existingIndex = updatedHeatmap.findIndex(item => item.date === data.date);\n                \n                if (existingIndex >= 0) {\n                  updatedHeatmap[existingIndex] = data;\n                } else {\n                  updatedHeatmap.push(data);\n                  updatedHeatmap.sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\n                }\n                \n                return {\n                  ...oldData,\n                  activity_heatmap: updatedHeatmap\n                };\n              }\n            );\n\n            onUpdate?.(data);\n          } catch (error) {\n            console.error('Error parsing WebSocket message:', error);\n          }\n        };\n\n        wsRef.current.onerror = (error) => {\n          console.error('WebSocket error:', error);\n          setIsConnected(false);\n        };\n\n        wsRef.current.onclose = () => {\n          setIsConnected(false);\n          console.log(`Disconnected from Git activity WebSocket for ${owner}/${repo}`);\n          \n          // Attempt to reconnect after 5 seconds\n          setTimeout(connect, 5000);\n        };\n      } catch (error) {\n        console.error('Failed to connect to WebSocket:', error);\n        setIsConnected(false);\n      }\n    };\n\n    connect();\n\n    return () => {\n      if (wsRef.current) {\n        wsRef.current.close();\n        wsRef.current = null;\n      }\n    };\n  }, [enabled, owner, repo, onUpdate, queryClient]);\n\n  return {\n    isConnected,\n    lastUpdate\n  };\n};\n\n/**\n * Hook for managing Git activity filters\n */\nexport const useGitActivityFilters = () => {\n  const [filters, setFilters] = useState<{\n    dateRange: { startDate: Date; endDate: Date };\n    activityTypes: ('commits' | 'prs' | 'reviews')[];\n    contributors: string[];\n    repositories: string[];\n  }>({\n    dateRange: {\n      startDate: new Date(Date.now() - 365 * 24 * 60 * 60 * 1000), // 1 year ago\n      endDate: new Date()\n    },\n    activityTypes: ['commits', 'prs', 'reviews'],\n    contributors: [],\n    repositories: []\n  });\n\n  const updateFilters = useCallback((newFilters: Partial<typeof filters>) => {\n    setFilters(prev => ({ ...prev, ...newFilters }));\n  }, []);\n\n  const resetFilters = useCallback(() => {\n    setFilters({\n      dateRange: {\n        startDate: new Date(Date.now() - 365 * 24 * 60 * 60 * 1000),\n        endDate: new Date()\n      },\n      activityTypes: ['commits', 'prs', 'reviews'],\n      contributors: [],\n      repositories: []\n    });\n  }, []);\n\n  const applyFilters = useCallback((data: ActivityHeatmapData[]) => {\n    return data.filter(item => {\n      const itemDate = new Date(item.date);\n      \n      // Date range filter\n      if (itemDate < filters.dateRange.startDate || itemDate > filters.dateRange.endDate) {\n        return false;\n      }\n      \n      // Activity type filter\n      const hasMatchingActivity = filters.activityTypes.some(type => {\n        switch (type) {\n          case 'commits':\n            return item.commit_count > 0;\n          case 'prs':\n            return item.pr_count > 0;\n          case 'reviews':\n            return item.activity_types.includes('review');\n          default:\n            return false;\n        }\n      });\n      \n      if (!hasMatchingActivity) return false;\n      \n      return true;\n    });\n  }, [filters]);\n\n  return {\n    filters,\n    updateFilters,\n    resetFilters,\n    applyFilters\n  };\n}; "],"names":["useGitActivityFilters","useGitActivityHeatmap","useMultiRepositoryActivity","useRealTimeGitActivity","useRepositoryHeatmap","owner","repo","options","provider","daysBack","useCache","forceRefresh","refreshInterval","enabled","queryClient","useQueryClient","error","setError","useState","queryKey","data","response","isLoading","queryError","refetch","queryRefetch","useQuery","queryFn","request","days_back","use_cache","force_refresh","gitActivityService","getRepositoryActivity","err","gitError","message","staleTime","refetchInterval","retry","failureCount","type","activity_heatmap","metrics","total_commits","total_prs","total_contributors","active_branches","lines_of_code","code_churn","avg_commits_per_day","avg_pr_size","top_contributors","velocity_trend","language_distribution","useCallback","invalidateCache","invalidateQueries","useEffect","loading","getRepositoryHeatmap","repositories","setLoading","setData","errors","setErrors","fetchAllRepositories","length","results","newErrors","promises","map","key","heatmapData","Promise","allSettled","onUpdate","isConnected","setIsConnected","lastUpdate","setLastUpdate","wsRef","useRef","wsUrl","process","env","NEXT_PUBLIC_WS_URL","connect","current","WebSocket","onopen","console","log","onmessage","event","JSON","parse","Date","setQueryData","oldData","updatedHeatmap","existingIndex","findIndex","item","date","push","sort","a","b","getTime","onerror","onclose","setTimeout","close","filters","setFilters","dateRange","startDate","now","endDate","activityTypes","contributors","updateFilters","newFilters","prev","resetFilters","applyFilters","filter","itemDate","hasMatchingActivity","some","commit_count","pr_count","activity_types","includes"],"mappings":"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"}
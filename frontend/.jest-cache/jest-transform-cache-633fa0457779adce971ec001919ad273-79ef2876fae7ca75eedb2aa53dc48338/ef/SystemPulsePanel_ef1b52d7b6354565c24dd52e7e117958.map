{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/dashboard/SystemPulsePanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useContext, useEffect, useMemo, useCallback, memo } from 'react';\nimport AnimatedIllustration from '../ui/AnimatedIllustration';\nimport StatusIndicator from '../ui/StatusIndicator';\nimport EmptyState from '../ui/EmptyState';\nimport { useSystemMetrics } from '../../hooks/useSystemMetrics';\nimport { trackEvent } from '../../utils/analytics';\nimport type { StatusType } from '../ui/StatusIndicator';\nimport { useSettings } from '../../contexts/SettingsContext';\n\ninterface Metric {\n  id: string;\n  title: string;\n  status: string;\n  value: string;\n  detail: string;\n}\n\n/**\n * Individual metric item component - memoized for performance\n */\nconst MetricItem = memo<{ metric: Metric }>(({ metric }) => (\n  <div key={metric.id} className=\"relative flex items-center gap-4 group hover:bg-blue-50 dark:hover:bg-blue-900/20 transition rounded-lg p-4\">\n    <AnimatedIllustration\n      name={metric.id === 'cicd' ? 'pipeline' : metric.id === 'k8s' ? 'k8s' : 'cloud'}\n      className=\"absolute right-2 bottom-2 w-20 h-20 opacity-15 pointer-events-none group-hover:scale-105 transition-transform duration-300\"\n      alt={metric.title}\n    />\n    <StatusIndicator status={metric.status as StatusType} />\n    <div className=\"z-10\">\n      <div className=\"font-medium\">{metric.title}</div>\n      <div className=\"text-xs text-gray-500\">{metric.value}</div>\n      {metric.detail && <div className=\"text-xs text-blue-400 mt-1\">{metric.detail}</div>}\n    </div>\n  </div>\n));\n\nMetricItem.displayName = 'MetricItem';\n\n/**\n * Left panel component displaying system health signals.\n * Shows key metrics with color-coded status indicators.\n * Optimized with React.memo and useMemo for better performance.\n */\nconst SystemPulsePanelComponent: React.FC = () => {\n  // const { refreshInterval } = useContext(SettingsContext) || { refreshInterval: 0 };\n  const { data, isLoading, error, refetch } = useSystemMetrics();\n  const [showUnhealthy, setShowUnhealthy] = React.useState(false);\n  const { panelVisibility, refreshInterval } = useSettings();\n\n  // Hide panel if not visible\n  if (!panelVisibility.systemPulse) return null;\n\n  // Memoized callback to prevent unnecessary re-renders\n  const handleRefresh = useCallback(async () => {\n    trackEvent('refresh', { panel: 'SystemPulse' });\n    await refetch();\n  }, [refetch]);\n\n  // Auto-refresh logic with memoized dependencies\n  useEffect(() => {\n    if (refreshInterval > 0) {\n      const interval = setInterval(() => {\n        trackEvent('auto-refresh', { panel: 'SystemPulse' });\n        refetch();\n      }, refreshInterval * 1000);\n      return () => clearInterval(interval);\n    }\n  }, [refreshInterval, refetch]);\n\n  // Memoized metrics parsing\n  const metrics: Metric[] = useMemo(() => {\n    return Array.isArray(data) ? data : [];\n  }, [data]);\n  // Memoized filtered metrics to prevent unnecessary filtering\n  const filteredMetrics = useMemo(() => {\n    return showUnhealthy\n      ? metrics.filter(m => m.status !== 'success')\n      : metrics;\n  }, [metrics, showUnhealthy]);\n\n  if (isLoading) {\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500 mb-2\" aria-label=\"Loading system metrics\" />\n        <span className=\"text-gray-500\">Loading system metrics...</span>\n      </section>\n    );\n  }\n\n  if (error) {\n    trackEvent('error', { panel: 'SystemPulse', error: String(error) });\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"Error Loading Metrics\"\n          description=\"We couldn't load your system metrics. Please try again.\"\n          action={{ label: 'Retry', onClick: handleRefresh }}\n        />\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 relative overflow-hidden min-h-[320px]\">\n      {/* Panel Controls */}\n      <div className=\"flex items-center justify-between mb-2\">\n        <label className=\"flex items-center gap-2 text-sm cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={showUnhealthy}\n            onChange={e => setShowUnhealthy(e.target.checked)}\n            className=\"accent-blue-500\"\n            aria-label=\"Show only unhealthy systems\"\n          />\n          Show only unhealthy systems\n        </label>\n        <div className=\"flex items-center gap-2\">\n          {refreshInterval > 0 && (\n            <span className=\"text-xs text-blue-400\" title=\"Auto-refresh enabled\">\n              Auto-refresh: {refreshInterval}s\n            </span>\n          )}\n          <button\n            onClick={handleRefresh}\n            className=\"px-3 py-1 rounded bg-blue-500 text-white font-medium hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 transition\"\n          >\n            Refresh\n          </button>\n        </div>\n      </div>\n      {/* Metrics or Empty State */}\n      {filteredMetrics.length === 0 ? (\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"No System Metrics\"\n          description=\"Everything is quiet. Enjoy your coffee â˜•\"\n          action={{ label: 'Refresh', onClick: handleRefresh }}\n        />\n      ) : (\n        <div className=\"flex flex-col gap-4\">\n          {filteredMetrics.map(metric => (\n            <MetricItem key={metric.id} metric={metric} />\n          ))}\n        </div>\n      )}\n    </section>\n  );\n};\n\n// Memoized component export with display name\nconst SystemPulsePanel = memo(SystemPulsePanelComponent, (prevProps, nextProps) => {\n  // Custom comparison function - since this component has no props,\n  // it only re-renders when internal state or context changes\n  return true; // Always consider props equal since there are no props\n});\n\nSystemPulsePanel.displayName = 'SystemPulsePanel';\n\nexport default SystemPulsePanel; "],"names":["MetricItem","memo","metric","div","className","AnimatedIllustration","name","id","alt","title","StatusIndicator","status","value","detail","displayName","SystemPulsePanelComponent","data","isLoading","error","refetch","useSystemMetrics","showUnhealthy","setShowUnhealthy","React","useState","panelVisibility","refreshInterval","useSettings","systemPulse","handleRefresh","useCallback","trackEvent","panel","useEffect","interval","setInterval","clearInterval","metrics","useMemo","Array","isArray","filteredMetrics","filter","m","section","aria-label","span","String","EmptyState","illustration","description","action","label","onClick","input","type","checked","onChange","e","target","button","length","map","SystemPulsePanel","prevProps","nextProps"],"mappings":"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"}
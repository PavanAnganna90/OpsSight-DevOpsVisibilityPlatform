{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/services/teamApi.ts"],"sourcesContent":["/**\n * Team API Service\n * \n * Service for connecting to team management backend endpoints.\n * Provides methods for team CRUD operations, member management, and team settings.\n */\n\nimport {\n  Team,\n  TeamCreate,\n  TeamUpdate,\n  TeamMember,\n  TeamMembershipRequest,\n  TeamMemberResponse,\n  TeamListResponse,\n  TeamMembersResponse,\n  TeamFilter,\n  TeamSortOptions,\n  TeamStats,\n  TeamInvitation,\n  TeamInvitationRequest,\n  TeamActivity\n} from '../types/team';\n\nclass TeamApiService {\n  private baseUrl: string;\n  \n  constructor() {\n    this.baseUrl = process.env.NODE_ENV === 'production' \n      ? '/api/v1/teams' \n      : 'http://localhost:8000/api/v1/teams';\n  }\n\n  private getAuthToken(): string | null {\n    return localStorage.getItem('authToken');\n  }\n\n  private async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {\n    const token = this.getAuthToken();\n    const url = `${this.baseUrl}${endpoint}`;\n    \n    const defaultHeaders: HeadersInit = {\n      'Content-Type': 'application/json',\n    };\n\n    if (token) {\n      defaultHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const config: RequestInit = {\n      ...options,\n      headers: {\n        ...defaultHeaders,\n        ...options.headers,\n      },\n    };\n\n    try {\n      const response = await fetch(url, config);\n      \n      if (response.status === 401) {\n        throw new Error('Authentication required. Please log in again.');\n      }\n      \n      if (response.status === 403) {\n        throw new Error('Access denied. You do not have permission to perform this action.');\n      }\n      \n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(`HTTP ${response.status}: ${errorText || response.statusText}`);\n      }\n      \n      return await response.json();\n    } catch (error) {\n      console.error(`Team API request failed: ${url}`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get teams with filtering, sorting, and pagination\n   */\n  async getTeams(\n    filter?: TeamFilter,\n    sort?: TeamSortOptions,\n    page: number = 1,\n    perPage: number = 20\n  ): Promise<TeamListResponse> {\n    const queryParams = new URLSearchParams();\n    \n    // Pagination\n    queryParams.append('page', page.toString());\n    queryParams.append('per_page', perPage.toString());\n    \n    // Sorting\n    if (sort) {\n      queryParams.append('sort_by', sort.field);\n      queryParams.append('sort_order', sort.direction);\n    }\n    \n    // Filtering\n    if (filter) {\n      if (filter.search) {\n        queryParams.append('search', filter.search);\n      }\n      \n      if (filter.role) {\n        queryParams.append('role', filter.role);\n      }\n      \n      if (filter.is_active !== undefined) {\n        queryParams.append('is_active', filter.is_active.toString());\n      }\n      \n      if (filter.created_by) {\n        queryParams.append('created_by', filter.created_by.toString());\n      }\n      \n      if (filter.member_of) {\n        queryParams.append('member_of', filter.member_of.toString());\n      }\n    }\n\n    return this.request<TeamListResponse>(`?${queryParams}`);\n  }\n\n  /**\n   * Get a specific team by ID\n   */\n  async getTeam(teamId: number): Promise<Team> {\n    return this.request<Team>(`/${teamId}`);\n  }\n\n  /**\n   * Create a new team\n   */\n  async createTeam(teamData: TeamCreate): Promise<Team> {\n    return this.request<Team>('', {\n      method: 'POST',\n      body: JSON.stringify(teamData),\n    });\n  }\n\n  /**\n   * Update an existing team\n   */\n  async updateTeam(teamId: number, teamData: TeamUpdate): Promise<Team> {\n    return this.request<Team>(`/${teamId}`, {\n      method: 'PUT',\n      body: JSON.stringify(teamData),\n    });\n  }\n\n  /**\n   * Delete a team\n   */\n  async deleteTeam(teamId: number): Promise<{ message: string }> {\n    return this.request<{ message: string }>(`/${teamId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  /**\n   * Get team members\n   */\n  async getTeamMembers(teamId: number): Promise<TeamMember[]> {\n    return this.request<TeamMember[]>(`/${teamId}/members`);\n  }\n\n  /**\n   * Add a member to a team\n   */\n  async addTeamMember(\n    teamId: number,\n    memberData: TeamMembershipRequest\n  ): Promise<TeamMemberResponse> {\n    return this.request<TeamMemberResponse>(`/${teamId}/members`, {\n      method: 'POST',\n      body: JSON.stringify(memberData),\n    });\n  }\n\n  /**\n   * Update a team member's role\n   */\n  async updateTeamMemberRole(\n    teamId: number,\n    userId: number,\n    role: string\n  ): Promise<TeamMemberResponse> {\n    return this.request<TeamMemberResponse>(`/${teamId}/members/${userId}`, {\n      method: 'PUT',\n      body: JSON.stringify({ role }),\n    });\n  }\n\n  /**\n   * Remove a member from a team\n   */\n  async removeTeamMember(teamId: number, userId: number): Promise<{ message: string }> {\n    return this.request<{ message: string }>(`/${teamId}/members/${userId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  /**\n   * Send team invitation\n   */\n  async inviteToTeam(\n    teamId: number,\n    invitationData: TeamInvitationRequest\n  ): Promise<TeamInvitation> {\n    return this.request<TeamInvitation>(`/${teamId}/invite`, {\n      method: 'POST',\n      body: JSON.stringify(invitationData),\n    });\n  }\n\n  /**\n   * Get team invitations\n   */\n  async getTeamInvitations(teamId: number): Promise<TeamInvitation[]> {\n    return this.request<TeamInvitation[]>(`/${teamId}/invitations`);\n  }\n\n  /**\n   * Cancel team invitation\n   */\n  async cancelInvitation(teamId: number, invitationId: number): Promise<{ message: string }> {\n    return this.request<{ message: string }>(`/${teamId}/invitations/${invitationId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  /**\n   * Accept team invitation\n   */\n  async acceptInvitation(token: string): Promise<TeamMemberResponse> {\n    return this.request<TeamMemberResponse>(`/invitations/accept`, {\n      method: 'POST',\n      body: JSON.stringify({ token }),\n    });\n  }\n\n  /**\n   * Get team statistics\n   */\n  async getTeamStats(): Promise<TeamStats> {\n    return this.request<TeamStats>('/stats');\n  }\n\n  /**\n   * Get team activity log\n   */\n  async getTeamActivity(\n    teamId: number,\n    limit: number = 50,\n    offset: number = 0\n  ): Promise<TeamActivity[]> {\n    const queryParams = new URLSearchParams({\n      limit: limit.toString(),\n      offset: offset.toString(),\n    });\n\n    return this.request<TeamActivity[]>(`/${teamId}/activity?${queryParams}`);\n  }\n\n  /**\n   * Check if user can perform action on team\n   */\n  async checkTeamPermission(\n    teamId: number,\n    action: 'view' | 'edit' | 'delete' | 'manage_members' | 'invite'\n  ): Promise<{ allowed: boolean; reason?: string }> {\n    return this.request<{ allowed: boolean; reason?: string }>(\n      `/${teamId}/permissions/${action}`\n    );\n  }\n\n  /**\n   * Get current user's teams\n   */\n  async getUserTeams(): Promise<Team[]> {\n    return this.request<Team[]>('/user/teams');\n  }\n\n  /**\n   * Leave a team (remove self)\n   */\n  async leaveTeam(teamId: number): Promise<{ message: string }> {\n    return this.request<{ message: string }>(`/${teamId}/leave`, {\n      method: 'POST',\n    });\n  }\n\n  /**\n   * Transfer team ownership\n   */\n  async transferOwnership(\n    teamId: number,\n    newOwnerId: number\n  ): Promise<{ message: string }> {\n    return this.request<{ message: string }>(`/${teamId}/transfer`, {\n      method: 'POST',\n      body: JSON.stringify({ new_owner_id: newOwnerId }),\n    });\n  }\n\n  /**\n   * Bulk add members to team\n   */\n  async bulkAddMembers(\n    teamId: number,\n    members: TeamMembershipRequest[]\n  ): Promise<{\n    successful: number;\n    failed: number;\n    results: TeamMemberResponse[];\n  }> {\n    return this.request<{\n      successful: number;\n      failed: number;\n      results: TeamMemberResponse[];\n    }>(`/${teamId}/members/bulk`, {\n      method: 'POST',\n      body: JSON.stringify({ members }),\n    });\n  }\n\n  /**\n   * Search for users to invite\n   */\n  async searchUsers(query: string, excludeTeamId?: number): Promise<{\n    users: {\n      id: number;\n      github_username: string;\n      email: string;\n      full_name: string | null;\n      avatar_url: string | null;\n    }[];\n  }> {\n    const queryParams = new URLSearchParams({ q: query });\n    if (excludeTeamId) {\n      queryParams.append('exclude_team', excludeTeamId.toString());\n    }\n\n    return this.request<{\n      users: {\n        id: number;\n        github_username: string;\n        email: string;\n        full_name: string | null;\n        avatar_url: string | null;\n      }[];\n    }>(`/search/users?${queryParams}`);\n  }\n\n  /**\n   * Get team health check\n   */\n  async getTeamHealth(): Promise<{\n    total_teams: number;\n    active_teams: number;\n    teams_without_owners: number;\n    teams_with_single_member: number;\n    average_team_size: number;\n    recommendations: string[];\n  }> {\n    return this.request<{\n      total_teams: number;\n      active_teams: number;\n      teams_without_owners: number;\n      teams_with_single_member: number;\n      average_team_size: number;\n      recommendations: string[];\n    }>('/health');\n  }\n}\n\n// Export singleton instance\nexport const teamApi = new TeamApiService();\nexport default teamApi; "],"names":["teamApi","TeamApiService","constructor","baseUrl","process","env","NODE_ENV","getAuthToken","localStorage","getItem","request","endpoint","options","token","url","defaultHeaders","config","headers","response","fetch","status","Error","ok","errorText","text","statusText","json","error","console","getTeams","filter","sort","page","perPage","queryParams","URLSearchParams","append","toString","field","direction","search","role","is_active","undefined","created_by","member_of","getTeam","teamId","createTeam","teamData","method","body","JSON","stringify","updateTeam","deleteTeam","getTeamMembers","addTeamMember","memberData","updateTeamMemberRole","userId","removeTeamMember","inviteToTeam","invitationData","getTeamInvitations","cancelInvitation","invitationId","acceptInvitation","getTeamStats","getTeamActivity","limit","offset","checkTeamPermission","action","getUserTeams","leaveTeam","transferOwnership","newOwnerId","new_owner_id","bulkAddMembers","members","searchUsers","query","excludeTeamId","q","getTeamHealth"],"mappings":"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"}
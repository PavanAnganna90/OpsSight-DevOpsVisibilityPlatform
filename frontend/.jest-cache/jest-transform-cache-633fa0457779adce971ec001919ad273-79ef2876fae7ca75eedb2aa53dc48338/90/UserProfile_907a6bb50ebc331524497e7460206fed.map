{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/auth/UserProfile.tsx"],"sourcesContent":["/**\n * User profile component for displaying authenticated user information.\n * Shows user avatar, name, GitHub profile details, and provides logout functionality.\n */\n\nimport React, { useState } from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { Avatar } from '../ui/Avatar';\nimport { UserRoleDisplay } from '../rbac/RoleBadge';\nimport { usePermissionState } from '../../hooks/usePermissions';\n\ninterface UserProfileProps {\n  /** Display variant - compact for headers, full for profile pages */\n  variant?: 'compact' | 'full';\n  /** Show logout button */\n  showLogout?: boolean;\n  /** Custom CSS classes */\n  className?: string;\n  /** Optional click handler for profile interaction */\n  onClick?: () => void;\n}\n\n/**\n * User Profile Component\n * \n * Displays authenticated user information with flexible layouts.\n * Supports both compact (for headers/navbars) and full (for profile pages) variants.\n * \n * Features:\n * - Responsive user avatar with fallback\n * - GitHub profile information display\n * - Logout functionality with confirmation\n * - Loading states during user operations\n * - Accessible keyboard navigation\n * - Design token integration\n * \n * @param variant - Display variant (compact or full)\n * @param showLogout - Whether to show logout button\n * @param className - Additional CSS classes\n * @param onClick - Optional click handler\n */\nexport const UserProfile: React.FC<UserProfileProps> = ({\n  variant = 'compact',\n  showLogout = true,\n  className = '',\n  onClick,\n}) => {\n  const { state, logout } = useAuth();\n  const [isLoggingOut, setIsLoggingOut] = useState(false);\n  const [showConfirm, setShowConfirm] = useState(false);\n  const permissionState = usePermissionState();\n\n  const { user } = state;\n\n  /**\n   * Handle logout with confirmation.\n   */\n  const handleLogout = async () => {\n    if (!showConfirm) {\n      setShowConfirm(true);\n      return;\n    }\n\n    try {\n      setIsLoggingOut(true);\n      await logout();\n    } catch (error) {\n      console.error('Logout failed:', error);\n      // Reason: Continue with logout even if API call fails\n    } finally {\n      setIsLoggingOut(false);\n      setShowConfirm(false);\n    }\n  };\n\n  /**\n   * Cancel logout confirmation.\n   */\n  const cancelLogout = () => {\n    setShowConfirm(false);\n  };\n\n\n\n  /**\n   * Format date for display.\n   */\n  const formatDate = (dateString: string | null): string => {\n    if (!dateString) return 'Not available';\n    \n    try {\n      const date = new Date(dateString);\n      return new Intl.DateTimeFormat('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric',\n      }).format(date);\n    } catch {\n      return 'Invalid date';\n    }\n  };\n\n  if (!user) {\n    return null;\n  }\n\n  /**\n   * Render compact variant for headers/navbars.\n   */\n  const renderCompact = () => (\n    <div \n      className={`flex items-center space-x-3 ${onClick ? 'cursor-pointer' : ''} ${className}`}\n      onClick={onClick}\n      onKeyDown={(e) => {\n        if ((e.key === 'Enter' || e.key === ' ') && onClick) {\n          e.preventDefault();\n          onClick();\n        }\n      }}\n      tabIndex={onClick ? 0 : undefined}\n      role={onClick ? 'button' : undefined}\n      aria-label={onClick ? `User profile: ${user.github_username}` : undefined}\n    >\n      {/* Avatar */}\n      <Avatar\n        src={user.avatar_url}\n        alt={`${user.github_username} avatar`}\n        name={user.full_name || user.github_username}\n        size=\"sm\"\n        priority={true} // Above-fold avatar should load immediately\n      />\n\n      {/* User info */}\n      <div className=\"flex-1 min-w-0\">\n        <p className=\"text-sm font-medium text-gray-900 truncate\">\n          {user.full_name || user.github_username}\n        </p>\n        <div className=\"flex items-center space-x-2\">\n          <p className=\"text-xs text-gray-500 truncate\">\n            @{user.github_username}\n          </p>\n          {user.roles && user.roles.length > 0 && (\n            <UserRoleDisplay user={user} size=\"sm\" variant=\"compact\" />\n          )}\n        </div>\n      </div>\n\n      {/* Logout button */}\n      {showLogout && (\n        <div className=\"relative\">\n          {!showConfirm ? (\n            <button\n              onClick={(e) => {\n                e.stopPropagation();\n                handleLogout();\n              }}\n              disabled={isLoggingOut}\n              className=\"p-1 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded disabled:opacity-50\"\n              aria-label=\"Logout\"\n              title=\"Logout\"\n            >\n              <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n              </svg>\n            </button>\n          ) : (\n            <div className=\"flex items-center space-x-2\">\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleLogout();\n                }}\n                disabled={isLoggingOut}\n                className=\"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50\"\n              >\n                {isLoggingOut ? 'Logging out...' : 'Confirm'}\n              </button>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  cancelLogout();\n                }}\n                disabled={isLoggingOut}\n                className=\"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2\"\n              >\n                Cancel\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n\n  /**\n   * Render full variant for profile pages.\n   */\n  const renderFull = () => (\n    <div className={`bg-white shadow rounded-lg p-6 ${className}`}>\n      <div className=\"flex items-start space-x-6\">\n        {/* Large avatar */}\n        <div className=\"flex-shrink-0\">\n          <Avatar\n            src={user.avatar_url}\n            alt={`${user.github_username} avatar`}\n            name={user.full_name || user.github_username}\n            size=\"2xl\"\n            priority={false} // Profile page avatar can use lazy loading\n          />\n        </div>\n\n        {/* User details */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">\n                {user.full_name || user.github_username}\n              </h1>\n              <p className=\"text-lg text-gray-600\">@{user.github_username}</p>\n            </div>\n            \n            {showLogout && (\n              <div>\n                {!showConfirm ? (\n                  <button\n                    onClick={handleLogout}\n                    disabled={isLoggingOut}\n                    className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50\"\n                  >\n                    <svg className=\"mr-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n                    </svg>\n                    Logout\n                  </button>\n                ) : (\n                  <div className=\"flex items-center space-x-3\">\n                    <button\n                      onClick={handleLogout}\n                      disabled={isLoggingOut}\n                      className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50\"\n                    >\n                      {isLoggingOut ? 'Logging out...' : 'Confirm Logout'}\n                    </button>\n                    <button\n                      onClick={cancelLogout}\n                      disabled={isLoggingOut}\n                      className=\"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                    >\n                      Cancel\n                    </button>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Bio */}\n          {user.bio && (\n            <p className=\"mt-4 text-gray-700\">{user.bio}</p>\n          )}\n\n          {/* Roles and Permissions */}\n          <div className=\"mt-6\">\n            <div className=\"mb-4\">\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Roles & Permissions</h3>\n              <div className=\"space-y-3\">\n                <div>\n                  <dt className=\"text-sm font-medium text-gray-500\">Assigned Roles</dt>\n                  <dd className=\"mt-1\">\n                    <UserRoleDisplay user={user} size=\"md\" variant=\"default\" />\n                  </dd>\n                </div>\n                <div>\n                  <dt className=\"text-sm font-medium text-gray-500\">Permission Summary</dt>\n                  <dd className=\"mt-1 text-sm text-gray-900\">\n                    {permissionState.permissions.length} permissions across {permissionState.roles.length} roles\n                    {permissionState.hasAnyAdminRole && (\n                      <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800\">\n                        Administrator\n                      </span>\n                    )}\n                  </dd>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Profile details */}\n          <div className=\"mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2\">\n            {user.email && (\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Email</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">{user.email}</dd>\n              </div>\n            )}\n            \n            {user.company && (\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Company</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">{user.company}</dd>\n              </div>\n            )}\n            \n            {user.location && (\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Location</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">{user.location}</dd>\n              </div>\n            )}\n            \n            {user.blog && (\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Website</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">\n                  <a \n                    href={user.blog.startsWith('http') ? user.blog : `https://${user.blog}`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-blue-600 hover:text-blue-500\"\n                  >\n                    {user.blog}\n                  </a>\n                </dd>\n              </div>\n            )}\n            \n            <div>\n              <dt className=\"text-sm font-medium text-gray-500\">Member since</dt>\n              <dd className=\"mt-1 text-sm text-gray-900\">{formatDate(user.created_at)}</dd>\n            </div>\n            \n            {user.last_login && (\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Last login</dt>\n                <dd className=\"mt-1 text-sm text-gray-900\">{formatDate(user.last_login)}</dd>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  return variant === 'compact' ? renderCompact() : renderFull();\n};\n\nexport default UserProfile; "],"names":["UserProfile","variant","showLogout","className","onClick","state","logout","useAuth","isLoggingOut","setIsLoggingOut","useState","showConfirm","setShowConfirm","permissionState","usePermissionState","user","handleLogout","error","console","cancelLogout","formatDate","dateString","date","Date","Intl","DateTimeFormat","year","month","day","format","renderCompact","div","onKeyDown","e","key","preventDefault","tabIndex","undefined","role","aria-label","github_username","Avatar","src","avatar_url","alt","name","full_name","size","priority","p","roles","length","UserRoleDisplay","button","stopPropagation","disabled","title","svg","fill","viewBox","stroke","path","strokeLinecap","strokeLinejoin","strokeWidth","d","renderFull","h1","bio","h3","dt","dd","permissions","hasAnyAdminRole","span","email","company","location","blog","a","href","startsWith","target","rel","created_at","last_login"],"mappings":"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"}
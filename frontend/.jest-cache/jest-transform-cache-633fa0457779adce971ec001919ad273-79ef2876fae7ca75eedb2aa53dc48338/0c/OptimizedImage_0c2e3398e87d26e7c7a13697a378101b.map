{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/ui/OptimizedImage.tsx"],"sourcesContent":["/**\n * Optimized Image Component\n * \n * Enhanced image component with lazy loading, error handling, and performance optimizations.\n * Provides fallback content and automatic optimization for better user experience.\n */\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport Image from 'next/image';\nimport { useIntersectionObserver } from '../../utils/performanceOptimizations';\n\ninterface OptimizedImageProps {\n  /** Image source URL */\n  src: string;\n  /** Alternative text for accessibility */\n  alt: string;\n  /** Image width */\n  width: number;\n  /** Image height */\n  height: number;\n  /** CSS classes */\n  className?: string;\n  /** Fallback content when image fails to load */\n  fallback?: React.ReactNode;\n  /** Priority loading (disable lazy loading) */\n  priority?: boolean;\n  /** Image quality (1-100) */\n  quality?: number;\n  /** Placeholder type */\n  placeholder?: 'blur' | 'empty';\n  /** Blur data URL for placeholder */\n  blurDataURL?: string;\n  /** Sizes attribute for responsive images */\n  sizes?: string;\n  /** Fill container (makes image responsive) */\n  fill?: boolean;\n  /** Object fit style */\n  objectFit?: 'contain' | 'cover' | 'fill' | 'none' | 'scale-down';\n  /** Object position */\n  objectPosition?: string;\n  /** Callback when image loads */\n  onLoad?: () => void;\n  /** Callback when image fails to load */\n  onError?: () => void;\n  /** Enable intersection observer lazy loading */\n  enableIntersectionObserver?: boolean;\n  /** Intersection observer threshold */\n  threshold?: number;\n}\n\n/**\n * OptimizedImage Component\n * \n * Features:\n * - Automatic lazy loading with Next.js Image\n * - Error handling with fallback content\n * - Automatic image optimization and compression\n * - Responsive image support\n * - Accessibility compliance\n * - Performance monitoring\n * \n * @param src - Image source URL\n * @param alt - Alternative text\n * @param width - Image width\n * @param height - Image height\n * @param className - CSS classes\n * @param fallback - Fallback content on error\n * @param priority - Disable lazy loading for above-fold images\n * @param quality - Image quality (1-100)\n * @param placeholder - Placeholder type\n * @param blurDataURL - Blur placeholder data\n * @param sizes - Responsive sizes\n * @param fill - Fill container mode\n * @param objectFit - Object fit behavior\n * @param objectPosition - Object position\n * @param onLoad - Load callback\n * @param onError - Error callback\n */\nconst OptimizedImageComponent: React.FC<OptimizedImageProps> = ({\n  src,\n  alt,\n  width,\n  height,\n  className = '',\n  fallback,\n  priority = false,\n  quality = 75,\n  placeholder = 'empty',\n  blurDataURL,\n  sizes,\n  fill = false,\n  objectFit = 'cover',\n  objectPosition = 'center',\n  onLoad,\n  onError,\n  enableIntersectionObserver = true,\n  threshold = 0.1,\n}) => {\n  const [hasError, setHasError] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  \n  // Use intersection observer for advanced lazy loading\n  const [observerRef, isIntersecting] = useIntersectionObserver({\n    threshold,\n    rootMargin: '50px', // Start loading 50px before image enters viewport\n  });\n  \n  // Determine if image should load\n  const shouldLoad = !enableIntersectionObserver || priority || isIntersecting;\n\n  /**\n   * Handle image load success\n   */\n  const handleLoad = useCallback(() => {\n    setIsLoading(false);\n    setHasError(false);\n    onLoad?.();\n  }, [onLoad]);\n\n  /**\n   * Handle image load error\n   */\n  const handleError = useCallback(() => {\n    setIsLoading(false);\n    setHasError(true);\n    onError?.();\n  }, [onError]);\n\n  /**\n   * Generate blur placeholder for better loading experience\n   */\n  const generatedBlurDataURL = useMemo(() => {\n    if (blurDataURL) return blurDataURL;\n    \n    // Generate a simple colored blur placeholder\n    const canvas = typeof window !== 'undefined' ? document.createElement('canvas') : null;\n    if (!canvas) return undefined;\n    \n    canvas.width = 10;\n    canvas.height = 10;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return undefined;\n    \n    // Create a simple gradient blur effect\n    const gradient = ctx.createLinearGradient(0, 0, 10, 10);\n    gradient.addColorStop(0, '#f3f4f6');\n    gradient.addColorStop(1, '#e5e7eb');\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, 0, 10, 10);\n    \n    return canvas.toDataURL();\n  }, [blurDataURL]);\n\n  /**\n   * Render fallback content when image fails\n   */\n  if (hasError && fallback) {\n    return <div className={className}>{fallback}</div>;\n  }\n\n  /**\n   * Common image props\n   */\n  const imageProps = {\n    src,\n    alt,\n    className: `transition-opacity duration-300 ${isLoading ? 'opacity-0' : 'opacity-100'} ${className}`,\n    priority,\n    quality,\n    placeholder: generatedBlurDataURL ? 'blur' as const : placeholder,\n    blurDataURL: generatedBlurDataURL,\n    sizes,\n    style: {\n      objectFit,\n      objectPosition,\n    },\n    onLoad: handleLoad,\n    onError: handleError,\n  };\n\n  // Don't render image if not supposed to load yet\n  if (!shouldLoad) {\n    return (\n      <div \n        ref={observerRef}\n        className={`relative bg-gray-200 dark:bg-gray-700 animate-pulse rounded ${className}`}\n        style={{ width: fill ? '100%' : width, height: fill ? '100%' : height }}\n      >\n        {/* Placeholder content */}\n        <div className=\"absolute inset-0 flex items-center justify-center text-gray-400\">\n          <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n          </svg>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div ref={observerRef} className=\"relative\">\n      {fill ? (\n        <Image\n          {...imageProps}\n          fill\n        />\n      ) : (\n        <Image\n          {...imageProps}\n          width={width}\n          height={height}\n        />\n      )}\n      \n      {/* Loading indicator */}\n      {isLoading && (\n        <div \n          className={`absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse rounded ${className}`}\n          style={{ width: fill ? '100%' : width, height: fill ? '100%' : height }}\n        />\n      )}\n    </div>\n  );\n};\n\n/**\n * Memoized OptimizedImage component to prevent unnecessary re-renders\n */\nexport const OptimizedImage = React.memo(OptimizedImageComponent);\n\nexport default OptimizedImage; "],"names":["OptimizedImage","OptimizedImageComponent","src","alt","width","height","className","fallback","priority","quality","placeholder","blurDataURL","sizes","fill","objectFit","objectPosition","onLoad","onError","enableIntersectionObserver","threshold","hasError","setHasError","useState","isLoading","setIsLoading","observerRef","isIntersecting","useIntersectionObserver","rootMargin","shouldLoad","handleLoad","useCallback","handleError","generatedBlurDataURL","useMemo","canvas","window","document","createElement","undefined","ctx","getContext","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","toDataURL","div","imageProps","style","ref","svg","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","Image","React","memo"],"mappings":"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"}
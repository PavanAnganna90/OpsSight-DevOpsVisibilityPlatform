{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/hooks/usePermissions.ts"],"sourcesContent":["/**\n * Permission Hooks\n * \n * Custom hooks for common permission checking patterns\n */\n\nimport { useMemo } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\n\n/**\n * Hook for checking multiple permissions\n */\nexport function usePermissions() {\n  const { hasPermission, hasRole, hasAnyRole, hasAnyPermission, canAccess, getUserPermissions, getUserRoles, isAdmin } = useAuth();\n\n  return {\n    hasPermission,\n    hasRole,\n    hasAnyRole,\n    hasAnyPermission,\n    canAccess,\n    getUserPermissions,\n    getUserRoles,\n    isAdmin,\n  };\n}\n\n/**\n * Hook for checking if user can perform CRUD operations on a resource\n */\nexport function useResourcePermissions(resource: string, organizationId?: string) {\n  const { canAccess } = useAuth();\n\n  return useMemo(() => ({\n    canView: canAccess(resource, 'view', organizationId),\n    canCreate: canAccess(resource, 'create', organizationId),\n    canUpdate: canAccess(resource, 'update', organizationId),\n    canDelete: canAccess(resource, 'delete', organizationId),\n    canManage: canAccess(resource, 'manage', organizationId),\n  }), [canAccess, resource, organizationId]);\n}\n\n/**\n * Hook for checking admin permissions\n */\nexport function useAdminPermissions() {\n  const { isAdmin, hasPermission, hasRole } = useAuth();\n\n  return useMemo(() => ({\n    isAdmin: isAdmin(),\n    canManageUsers: hasPermission('manage_users'),\n    canManageRoles: hasPermission('manage_roles'),\n    canManagePermissions: hasPermission('manage_permissions'),\n    canManageTeams: hasPermission('manage_teams'),\n    canManageSystem: hasPermission('manage_system'),\n    canViewAuditLogs: hasPermission('view_audit_logs'),\n    isOrgOwner: hasRole('organization_owner'),\n    isDevOpsAdmin: hasRole('devops_admin'),\n  }), [isAdmin, hasPermission, hasRole]);\n}\n\n/**\n * Hook for checking infrastructure permissions\n */\nexport function useInfrastructurePermissions(organizationId?: string) {\n  const { hasPermission, canAccess } = useAuth();\n\n  return useMemo(() => ({\n    canViewInfrastructure: canAccess('infrastructure', 'view', organizationId),\n    canManageInfrastructure: canAccess('infrastructure', 'manage', organizationId),\n    canManageClusters: hasPermission('manage_clusters', organizationId),\n    canViewClusters: hasPermission('view_clusters', organizationId),\n    canManageDeployments: hasPermission('manage_deployments', organizationId),\n    canViewDeployments: hasPermission('view_deployments', organizationId),\n    canManageMonitoring: hasPermission('manage_monitoring', organizationId),\n    canViewMonitoring: hasPermission('view_monitoring', organizationId),\n    canManagePipelines: hasPermission('manage_pipelines', organizationId),\n    canViewPipelines: hasPermission('view_pipelines', organizationId),\n  }), [hasPermission, canAccess, organizationId]);\n}\n\n/**\n * Hook for checking team permissions\n */\nexport function useTeamPermissions(organizationId?: string) {\n  const { hasPermission, canAccess } = useAuth();\n\n  return useMemo(() => ({\n    canViewTeams: canAccess('teams', 'view', organizationId),\n    canCreateTeams: canAccess('teams', 'create', organizationId),\n    canUpdateTeams: canAccess('teams', 'update', organizationId),\n    canDeleteTeams: canAccess('teams', 'delete', organizationId),\n    canManageTeamMembers: hasPermission('manage_team_members', organizationId),\n    canViewTeamMembers: hasPermission('view_team_members', organizationId),\n    canAssignRoles: hasPermission('assign_roles', organizationId),\n  }), [hasPermission, canAccess, organizationId]);\n}\n\n/**\n * Hook for checking navigation permissions\n */\nexport function useNavigationPermissions() {\n  const { hasPermission, hasAnyRole, isAdmin } = useAuth();\n\n  return useMemo(() => ({\n    canViewDashboard: hasPermission('view_dashboard'),\n    canViewInfrastructure: hasPermission('view_infrastructure'),\n    canViewPipelines: hasPermission('view_pipelines'),\n    canViewAutomation: hasPermission('view_automation'),\n    canViewTeams: hasPermission('view_teams'),\n    canViewUsers: hasPermission('view_users'),\n    canViewRoles: hasPermission('view_roles'),\n    canViewSettings: hasPermission('view_settings'),\n    canViewAdmin: isAdmin(),\n    canViewMonitoring: hasPermission('view_monitoring'),\n    canViewReports: hasPermission('view_reports'),\n    canViewAuditLogs: hasPermission('view_audit_logs'),\n    isManagerOrAbove: hasAnyRole(['manager', 'devops_admin', 'organization_owner', 'super_admin']),\n    isDevOpsRole: hasAnyRole(['devops_admin', 'engineer', 'organization_owner', 'super_admin']),\n  }), [hasPermission, hasAnyRole, isAdmin]);\n}\n\n/**\n * Hook for checking if user can access specific features\n */\nexport function useFeaturePermissions() {\n  const { hasPermission, hasRole } = useAuth();\n\n  return useMemo(() => ({\n    canUseCLI: hasPermission('api_access'),\n    canUseAPI: hasPermission('api_access'),\n    canUseWebhooks: hasPermission('webhook_management'),\n    canViewCosts: hasPermission('view_cost_analysis'),\n    canManageCosts: hasPermission('manage_cost_analysis'),\n    canViewAlerts: hasPermission('view_alerts'),\n    canManageAlerts: hasPermission('manage_alerts'),\n    canViewNotifications: hasPermission('view_notifications'),\n    canManageNotifications: hasPermission('manage_notifications'),\n    canViewIntegrations: hasPermission('view_integrations'),\n    canManageIntegrations: hasPermission('manage_integrations'),\n    canExportData: hasPermission('export_data'),\n    canImportData: hasPermission('import_data'),\n    hasAPIOnlyAccess: hasRole('api_only'),\n  }), [hasPermission, hasRole]);\n}\n\n/**\n * Hook for permission-based UI state\n */\nexport function usePermissionState() {\n  const auth = useAuth();\n  const adminPerms = useAdminPermissions();\n  const navPerms = useNavigationPermissions();\n  const featurePerms = useFeaturePermissions();\n\n  return useMemo(() => ({\n    isAuthenticated: auth.state.isAuthenticated,\n    user: auth.state.user,\n    roles: auth.getUserRoles(),\n    permissions: auth.getUserPermissions(),\n    admin: adminPerms,\n    navigation: navPerms,\n    features: featurePerms,\n    hasAnyAdminRole: adminPerms.isAdmin,\n    hasAnyManagerRole: navPerms.isManagerOrAbove,\n    hasAnyDevOpsRole: navPerms.isDevOpsRole,\n  }), [auth, adminPerms, navPerms, featurePerms]);\n}"],"names":["useAdminPermissions","useFeaturePermissions","useInfrastructurePermissions","useNavigationPermissions","usePermissionState","usePermissions","useResourcePermissions","useTeamPermissions","hasPermission","hasRole","hasAnyRole","hasAnyPermission","canAccess","getUserPermissions","getUserRoles","isAdmin","useAuth","resource","organizationId","useMemo","canView","canCreate","canUpdate","canDelete","canManage","canManageUsers","canManageRoles","canManagePermissions","canManageTeams","canManageSystem","canViewAuditLogs","isOrgOwner","isDevOpsAdmin","canViewInfrastructure","canManageInfrastructure","canManageClusters","canViewClusters","canManageDeployments","canViewDeployments","canManageMonitoring","canViewMonitoring","canManagePipelines","canViewPipelines","canViewTeams","canCreateTeams","canUpdateTeams","canDeleteTeams","canManageTeamMembers","canViewTeamMembers","canAssignRoles","canViewDashboard","canViewAutomation","canViewUsers","canViewRoles","canViewSettings","canViewAdmin","canViewReports","isManagerOrAbove","isDevOpsRole","canUseCLI","canUseAPI","canUseWebhooks","canViewCosts","canManageCosts","canViewAlerts","canManageAlerts","canViewNotifications","canManageNotifications","canViewIntegrations","canManageIntegrations","canExportData","canImportData","hasAPIOnlyAccess","auth","adminPerms","navPerms","featurePerms","isAuthenticated","state","user","roles","permissions","admin","navigation","features","hasAnyAdminRole","hasAnyManagerRole","hasAnyDevOpsRole"],"mappings":"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"}
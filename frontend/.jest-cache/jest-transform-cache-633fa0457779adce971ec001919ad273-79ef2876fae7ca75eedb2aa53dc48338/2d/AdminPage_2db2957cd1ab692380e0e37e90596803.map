{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/admin/AdminPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport AppShell from '../layout/AppShell';\nimport RoleList from './RoleList';\nimport RoleDetail from './RoleDetail';\nimport PermissionAssignment from './PermissionAssignment';\nimport LoadingSpinner from '../common/LoadingSpinner';\nimport RoleCreateModal from './RoleCreateModal';\nimport RoleManagementPage from './role-management/RoleManagementPage';\nimport { PermissionGuard, AdminOnly } from '../rbac/PermissionGuard';\n\n/**\n * AdminPage - Main admin UI for role and permission management in OpsSight.\n * Provides tabbed interface for legacy role management and new RBAC system.\n * Now includes RoleCreateModal for creating new roles and supports editing, deleting roles and permissions.\n */\nconst AdminPage: React.FC = () => {\n  const [activeTab, setActiveTab] = useState<'legacy' | 'rbac'>('rbac');\n  const [roles, setRoles] = useState<Array<any>>([]);\n  const [selected, setSelected] = useState<any | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [permissions, setPermissions] = useState<string[]>([]); // assigned permissions (names)\n  const [allPermissions, setAllPermissions] = useState<any[]>([]); // all permission objects\n  const [showCreate, setShowCreate] = useState(false);\n  const [createLoading, setCreateLoading] = useState(false);\n  const [createError, setCreateError] = useState('');\n  const [showSuccess, setShowSuccess] = useState(false);\n  // Edit state\n  const [editLoading, setEditLoading] = useState(false);\n  const [editError, setEditError] = useState('');\n  const [editSuccess, setEditSuccess] = useState(false);\n  // Permission update state\n  const [permLoading, setPermLoading] = useState(false);\n  const [permError, setPermError] = useState('');\n  const [permSuccess, setPermSuccess] = useState(false);\n  // Delete state\n  const [deleteLoading, setDeleteLoading] = useState(false);\n  const [deleteError, setDeleteError] = useState('');\n  const [deleteSuccess, setDeleteSuccess] = useState(false);\n\n  // Fetch roles on mount\n  useEffect(() => {\n    fetch('/api/v1/roles')\n      .then(res => res.json())\n      .then(data => {\n        setRoles(data);\n        if (data.length > 0) setSelected(data[0]);\n      })\n      .catch(() => setError('Failed to load roles'))\n      .finally(() => setLoading(false));\n  }, []);\n\n  // Fetch all permissions on mount\n  useEffect(() => {\n    fetch('/api/v1/permissions')\n      .then(res => res.json())\n      .then(data => setAllPermissions(data))\n      .catch(() => setAllPermissions([]));\n  }, []);\n\n  // Fetch assigned permissions for selected role\n  useEffect(() => {\n    if (!selected) return;\n    fetch(`/api/v1/roles/${selected.id}/permissions`)\n      .then(res => res.json())\n      .then(data => setPermissions(data.permissions ? data.permissions.map((p: any) => p.name) : []))\n      .catch(() => setPermissions([]));\n  }, [selected]);\n\n  const handleRoleSelect = (role: any) => setSelected(role);\n\n  // Handle role edit (display_name, description)\n  const handleRoleEdit = async (updated: { display_name: string; description?: string }) => {\n    if (!selected) return;\n    setEditLoading(true);\n    setEditError('');\n    try {\n      const res = await fetch(`/api/v1/roles/${selected.id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(updated),\n      });\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.detail || 'Failed to update role');\n      }\n      const updatedRole = await res.json();\n      setRoles(prev => prev.map(r => (r.id === updatedRole.id ? updatedRole : r)));\n      setSelected(updatedRole);\n      setEditSuccess(true);\n      setTimeout(() => setEditSuccess(false), 2500);\n    } catch (e: any) {\n      setEditError(e.message || 'Failed to update role');\n    } finally {\n      setEditLoading(false);\n    }\n  };\n\n  const handleRoleSave = handleRoleEdit; // For clarity in prop passing\n  const handleRoleCancel = () => setEditError('');\n\n  // Handle permission assignment update\n  const handlePermissionChange = async (updated: string[]) => {\n    if (!selected) return;\n    setPermLoading(true);\n    setPermError('');\n    try {\n      // Map permission names to IDs\n      const updatedIds = allPermissions.filter(p => updated.includes(p.name)).map(p => p.id);\n      const res = await fetch(`/api/v1/roles/${selected.id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ permission_ids: updatedIds }),\n      });\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.detail || 'Failed to update permissions');\n      }\n      const updatedRole = await res.json();\n      setRoles(prev => prev.map(r => (r.id === updatedRole.id ? updatedRole : r)));\n      setSelected(updatedRole);\n      setPermissions(updated);\n      setPermSuccess(true);\n      setTimeout(() => setPermSuccess(false), 2000);\n    } catch (e: any) {\n      setPermError(e.message || 'Failed to update permissions');\n    } finally {\n      setPermLoading(false);\n    }\n  };\n\n  // Handle role creation with robust error/success feedback\n  const handleCreateRole = async (role: { name: string; display_name: string; description?: string; permission_ids?: number[] }) => {\n    setCreateLoading(true);\n    setCreateError('');\n    try {\n      const res = await fetch('/api/v1/roles', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(role),\n      });\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.detail || 'Failed to create role');\n      }\n      const newRole = await res.json();\n      setRoles(prev => [...prev, newRole]);\n      setSelected(newRole);\n      setShowCreate(false);\n      setShowSuccess(true);\n      setTimeout(() => setShowSuccess(false), 2500);\n    } catch (e: any) {\n      setCreateError(e.message || 'Failed to create role');\n    } finally {\n      setCreateLoading(false);\n    }\n  };\n\n  // Handle role deletion\n  const handleDeleteRole = async () => {\n    if (!selected) return;\n    if (!window.confirm(`Are you sure you want to delete the role \"${selected.display_name}\"? This action cannot be undone.`)) return;\n    setDeleteLoading(true);\n    setDeleteError('');\n    try {\n      const res = await fetch(`/api/v1/roles/${selected.id}`, {\n        method: 'DELETE',\n      });\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.detail || 'Failed to delete role');\n      }\n      setRoles(prev => prev.filter(r => r.id !== selected.id));\n      // Select next available role or null\n      const idx = roles.findIndex(r => r.id === selected.id);\n      const next = roles[idx + 1] || roles[idx - 1] || null;\n      setSelected(next);\n      setDeleteSuccess(true);\n      setTimeout(() => setDeleteSuccess(false), 2500);\n    } catch (e: any) {\n      setDeleteError(e.message || 'Failed to delete role');\n    } finally {\n      setDeleteLoading(false);\n    }\n  };\n\n  // Reset error/loading state on modal close\n  const handleCloseModal = () => {\n    setShowCreate(false);\n    setCreateError('');\n    setCreateLoading(false);\n  };\n\n  if (loading) return <AppShell><LoadingSpinner /></AppShell>;\n  if (error) return <AppShell><div className=\"text-red-500\">{error}</div></AppShell>;\n\n  return (\n    <AppShell>\n      <AdminOnly fallback={\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-center\">\n            <div className=\"text-red-500 mb-2\">\n              <svg className=\"w-12 h-12 mx-auto\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m0-6v2m0-4v.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n            </div>\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">Access Denied</h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">You don't have permission to access the admin panel.</p>\n          </div>\n        </div>\n      }>\n        {/* Success Toasts */}\n        {showSuccess && (\n          <div className=\"fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded shadow z-50 animate-fade-in\">\n            Role created successfully!\n          </div>\n        )}\n        {editSuccess && (\n          <div className=\"fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow z-50 animate-fade-in\">\n            Role updated successfully!\n          </div>\n        )}\n        {permSuccess && (\n          <div className=\"fixed top-4 right-4 bg-green-700 text-white px-4 py-2 rounded shadow z-50 animate-fade-in\">\n            Permissions updated!\n          </div>\n        )}\n        {deleteSuccess && (\n          <div className=\"fixed top-4 right-4 bg-red-600 text-white px-4 py-2 rounded shadow z-50 animate-fade-in\">\n            Role deleted.\n          </div>\n        )}\n        \n        <PermissionGuard permission=\"role:create\">\n          <RoleCreateModal\n            open={showCreate}\n            onClose={handleCloseModal}\n            onCreate={handleCreateRole}\n            creationLoading={createLoading}\n            creationError={createError}\n            onSuccess={() => setShowSuccess(true)}\n          />\n        </PermissionGuard>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <div>\n            <div className=\"flex items-center justify-between mb-2\">\n              <h3 className=\"font-bold\">Roles</h3>\n              <PermissionGuard permission=\"role:create\">\n                <button\n                  className=\"px-3 py-1 rounded bg-blue-600 text-white text-sm hover:bg-blue-700\"\n                  onClick={() => setShowCreate(true)}\n                  disabled={createLoading}\n                >\n                  + New Role\n                </button>\n              </PermissionGuard>\n            </div>\n            <RoleList roles={roles} onSelect={handleRoleSelect} />\n          </div>\n          <div>\n            {selected && (\n              <>\n                <PermissionGuard permission=\"role:update\">\n                  <RoleDetail\n                    role={{ ...selected, permissions }}\n                    onSave={handleRoleSave}\n                    onCancel={handleRoleCancel}\n                    loading={editLoading}\n                  />\n                </PermissionGuard>\n                <PermissionGuard permission=\"role:delete\">\n                  <button\n                    className=\"mt-4 px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700\"\n                    onClick={handleDeleteRole}\n                    disabled={deleteLoading}\n                  >\n                    {deleteLoading ? 'Deleting...' : 'Delete Role'}\n                  </button>\n                  {deleteError && <div className=\"text-red-500 mt-2\">{deleteError}</div>}\n                </PermissionGuard>\n              </>\n            )}\n            {editError && <div className=\"text-red-500 mt-2\">{editError}</div>}\n          </div>\n          <div>\n            {selected && (\n              <PermissionGuard permission=\"role:manage\">\n                <div className=\"bg-white dark:bg-gray-900 rounded shadow p-4\">\n                  <h3 className=\"font-bold mb-2\">Assign Permissions</h3>\n                  <PermissionAssignment\n                    allPermissions={allPermissions}\n                    assigned={permissions}\n                    onChange={handlePermissionChange}\n                    loading={permLoading}\n                    error={permError}\n                  />\n                  {permError && <div className=\"text-red-500 mt-2\">{permError}</div>}\n                </div>\n              </PermissionGuard>\n            )}\n          </div>\n        </div>\n      </AdminOnly>\n    </AppShell>\n  );\n};\n\nexport default AdminPage; "],"names":["AdminPage","activeTab","setActiveTab","useState","roles","setRoles","selected","setSelected","loading","setLoading","error","setError","permissions","setPermissions","allPermissions","setAllPermissions","showCreate","setShowCreate","createLoading","setCreateLoading","createError","setCreateError","showSuccess","setShowSuccess","editLoading","setEditLoading","editError","setEditError","editSuccess","setEditSuccess","permLoading","setPermLoading","permError","setPermError","permSuccess","setPermSuccess","deleteLoading","setDeleteLoading","deleteError","setDeleteError","deleteSuccess","setDeleteSuccess","useEffect","fetch","then","res","json","data","length","catch","finally","id","map","p","name","handleRoleSelect","role","handleRoleEdit","updated","method","headers","body","JSON","stringify","ok","err","Error","detail","updatedRole","prev","r","setTimeout","e","message","handleRoleSave","handleRoleCancel","handlePermissionChange","updatedIds","filter","includes","permission_ids","handleCreateRole","newRole","handleDeleteRole","window","confirm","display_name","idx","findIndex","next","handleCloseModal","AppShell","LoadingSpinner","div","className","AdminOnly","fallback","svg","fill","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","h3","PermissionGuard","permission","RoleCreateModal","open","onClose","onCreate","creationLoading","creationError","onSuccess","button","onClick","disabled","RoleList","onSelect","RoleDetail","onSave","onCancel","PermissionAssignment","assigned","onChange"],"mappings":"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"}
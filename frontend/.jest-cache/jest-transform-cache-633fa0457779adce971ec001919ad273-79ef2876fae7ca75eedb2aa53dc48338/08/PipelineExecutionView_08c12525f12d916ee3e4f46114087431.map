{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/dashboard/PipelineExecutionView.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { \n  useExpensiveMemo, \n  useStableCallback, \n  withMemo, \n  shallowEqual,\n  useRenderPerformance \n} from '../../utils/performanceOptimizations';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { io, Socket } from 'socket.io-client';\nimport { format, formatDistanceToNow } from 'date-fns';\nimport { \n  Activity, \n  CheckCircle, \n  XCircle, \n  Clock, \n  PlayCircle,\n  Pause,\n  RefreshCw,\n  GitBranch,\n  User,\n  Calendar,\n  Timer,\n  AlertCircle,\n  Loader2,\n  Zap\n} from 'lucide-react';\n\n// Types for pipeline execution data\ninterface PipelineRun {\n  id: number;\n  pipeline_id: number;\n  run_number: number;\n  status: 'pending' | 'running' | 'success' | 'failure' | 'cancelled';\n  commit_sha: string;\n  commit_message?: string;\n  triggered_by: string;\n  trigger_event: 'push' | 'pull_request' | 'schedule' | 'manual';\n  started_at: string;\n  finished_at?: string;\n  duration_seconds?: number;\n  branch: string;\n  steps?: PipelineStep[];\n  logs?: string[];\n}\n\ninterface PipelineStep {\n  id: number;\n  name: string;\n  status: 'pending' | 'running' | 'success' | 'failure' | 'skipped';\n  started_at?: string;\n  finished_at?: string;\n  duration_seconds?: number;\n  logs?: string[];\n}\n\ninterface Pipeline {\n  id: number;\n  name: string;\n  repository_url: string;\n  branch: string;\n  is_active: boolean;\n}\n\ninterface PipelineExecutionViewProps {\n  className?: string;\n  maxRuns?: number;\n  autoRefresh?: boolean;\n  showLogs?: boolean;\n}\n\n// Custom hook for WebSocket connection\nconst useWebSocket = (url: string, options: { enabled: boolean }) => {\n  const [socket, setSocket] = useState<Socket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!options.enabled) return;\n\n    const socketInstance = io(url, {\n      transports: ['websocket', 'polling'],\n      timeout: 20000,\n      retries: 3,\n      ackTimeout: 10000,\n    });\n\n    socketInstance.on('connect', () => {\n      setIsConnected(true);\n      setError(null);\n      console.log('Pipeline WebSocket connected');\n    });\n\n    socketInstance.on('disconnect', (reason, details) => {\n      setIsConnected(false);\n      console.log('Pipeline WebSocket disconnected:', reason, details);\n    });\n\n    socketInstance.on('connect_error', (error) => {\n      setError(error.message);\n      console.error('Pipeline WebSocket connection error:', error);\n    });\n\n    setSocket(socketInstance);\n\n    return () => {\n      socketInstance.disconnect();\n      setSocket(null);\n      setIsConnected(false);\n    };\n  }, [url, options.enabled]);\n\n  return { socket, isConnected, error };\n};\n\n// Status badge component\nconst StatusBadge: React.FC<{ status: string; size?: 'sm' | 'md' }> = ({ \n  status, \n  size = 'md' \n}) => {\n  const statusConfig = {\n    pending: { icon: Clock, color: 'text-gray-500 bg-gray-100', label: 'Pending' },\n    running: { icon: Loader2, color: 'text-blue-500 bg-blue-100', label: 'Running' },\n    success: { icon: CheckCircle, color: 'text-green-500 bg-green-100', label: 'Success' },\n    failure: { icon: XCircle, color: 'text-red-500 bg-red-100', label: 'Failed' },\n    cancelled: { icon: AlertCircle, color: 'text-yellow-500 bg-yellow-100', label: 'Cancelled' },\n    skipped: { icon: AlertCircle, color: 'text-gray-400 bg-gray-50', label: 'Skipped' },\n  };\n\n  const config = statusConfig[status as keyof typeof statusConfig] || statusConfig.pending;\n  const Icon = config.icon;\n  const sizeClasses = size === 'sm' ? 'text-xs px-2 py-1' : 'text-sm px-3 py-1.5';\n\n  return (\n    <span className={`inline-flex items-center gap-1.5 rounded-full font-medium ${config.color} ${sizeClasses}`}>\n      <Icon className={`${size === 'sm' ? 'h-3 w-3' : 'h-4 w-4'} ${status === 'running' ? 'animate-spin' : ''}`} />\n      {config.label}\n    </span>\n  );\n};\n\n// Duration component\nconst Duration: React.FC<{ \n  startedAt: string; \n  finishedAt?: string; \n  isRunning?: boolean;\n  className?: string;\n}> = ({ startedAt, finishedAt, isRunning, className = '' }) => {\n  const [currentTime, setCurrentTime] = useState(Date.now());\n\n  useEffect(() => {\n    if (!isRunning) return;\n    \n    const interval = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [isRunning]);\n\n  const duration = useMemo(() => {\n    const start = new Date(startedAt).getTime();\n    const end = finishedAt ? new Date(finishedAt).getTime() : currentTime;\n    const diffInSeconds = Math.floor((end - start) / 1000);\n    \n    const minutes = Math.floor(diffInSeconds / 60);\n    const seconds = diffInSeconds % 60;\n    \n    return `${minutes}m ${seconds}s`;\n  }, [startedAt, finishedAt, currentTime]);\n\n  return (\n    <span className={`inline-flex items-center gap-1 text-sm text-gray-600 ${className}`}>\n      <Timer className=\"h-4 w-4\" />\n      {duration}\n    </span>\n  );\n};\n\n// Pipeline run item component\nconst PipelineRunItem: React.FC<{ \n  run: PipelineRun; \n  pipeline: Pipeline;\n  isExpanded: boolean;\n  onToggleExpand: () => void;\n  showLogs: boolean;\n}> = ({ run, pipeline, isExpanded, onToggleExpand, showLogs }) => {\n  const isRunning = run.status === 'running';\n  const hasSteps = run.steps && run.steps.length > 0;\n\n  return (\n    <div className=\"border rounded-lg p-4 bg-white shadow-sm hover:shadow-md transition-shadow\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center gap-3\">\n          <StatusBadge status={run.status} />\n          <div>\n            <h3 className=\"font-semibold text-gray-900\">\n              {pipeline.name} #{run.run_number}\n            </h3>\n            <p className=\"text-sm text-gray-600\">{run.commit_message || 'No commit message'}</p>\n          </div>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {isRunning && (\n            <Duration \n              startedAt={run.started_at} \n              finishedAt={run.finished_at} \n              isRunning={isRunning}\n            />\n          )}\n          {hasSteps && (\n            <button\n              onClick={onToggleExpand}\n              className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n            >\n              <RefreshCw className={`h-4 w-4 transform transition-transform ${isExpanded ? 'rotate-180' : ''}`} />\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Metadata */}\n      <div className=\"flex flex-wrap items-center gap-4 text-sm text-gray-600 mb-3\">\n        <span className=\"flex items-center gap-1\">\n          <GitBranch className=\"h-4 w-4\" />\n          {run.branch}\n        </span>\n        <span className=\"flex items-center gap-1\">\n          <User className=\"h-4 w-4\" />\n          {run.triggered_by}\n        </span>\n        <span className=\"flex items-center gap-1\">\n          <Calendar className=\"h-4 w-4\" />\n          {formatDistanceToNow(new Date(run.started_at), { addSuffix: true })}\n        </span>\n        <span className=\"flex items-center gap-1\">\n          <Zap className=\"h-4 w-4\" />\n          {run.trigger_event}\n        </span>\n      </div>\n\n      {/* Steps (when expanded) */}\n      {isExpanded && hasSteps && (\n        <div className=\"mt-4 space-y-2\">\n          <h4 className=\"font-medium text-gray-900 mb-2\">Pipeline Steps</h4>\n          {run.steps!.map((step) => (\n            <div key={step.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded\">\n              <div className=\"flex items-center gap-3\">\n                <StatusBadge status={step.status} size=\"sm\" />\n                <span className=\"font-medium text-gray-900\">{step.name}</span>\n              </div>\n              {step.duration_seconds && (\n                <span className=\"text-sm text-gray-600\">\n                  {Math.floor(step.duration_seconds / 60)}m {step.duration_seconds % 60}s\n                </span>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Logs (when expanded and enabled) */}\n      {isExpanded && showLogs && run.logs && run.logs.length > 0 && (\n        <div className=\"mt-4\">\n          <h4 className=\"font-medium text-gray-900 mb-2\">Recent Logs</h4>\n          <div className=\"bg-gray-900 text-green-400 p-3 rounded font-mono text-sm max-h-40 overflow-y-auto\">\n            {run.logs.slice(-10).map((log, index) => (\n              <div key={index} className=\"whitespace-pre-wrap\">{log}</div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Main component\nexport const PipelineExecutionView: React.FC<PipelineExecutionViewProps> = ({\n  className = '',\n  maxRuns = 10,\n  autoRefresh = true,\n  showLogs = false,\n}) => {\n  const [expandedRuns, setExpandedRuns] = useState<Set<number>>(new Set());\n  const [selectedPipeline, setSelectedPipeline] = useState<number | 'all'>('all');\n  const queryClient = useQueryClient();\n\n  // WebSocket connection\n  const { socket, isConnected, error: wsError } = useWebSocket(\n    process.env.NEXT_PUBLIC_WS_URL || 'http://localhost:8000',\n    { enabled: autoRefresh }\n  );\n\n  // Fetch pipelines\n  const { data: pipelines = [], isLoading: pipelinesLoading } = useQuery({\n    queryKey: ['pipelines'],\n    queryFn: async () => {\n      const response = await fetch('/api/pipelines');\n      if (!response.ok) throw new Error('Failed to fetch pipelines');\n      return response.json();\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // Fetch pipeline runs\n  const { data: runs = [], isLoading: runsLoading, error: runsError } = useQuery({\n    queryKey: ['pipeline-runs', selectedPipeline, maxRuns],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        limit: maxRuns.toString(),\n        ...(selectedPipeline !== 'all' && { pipeline_id: selectedPipeline.toString() }),\n      });\n      \n      const response = await fetch(`/api/pipeline-runs?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch pipeline runs');\n      return response.json();\n    },\n    refetchInterval: autoRefresh && !isConnected ? 30000 : false, // Fallback polling\n    staleTime: 10000, // 10 seconds\n  });\n\n  // Handle real-time updates via WebSocket\n  const handleRunUpdate = useCallback((updatedRun: PipelineRun) => {\n    queryClient.setQueryData(['pipeline-runs', selectedPipeline, maxRuns], (oldData: PipelineRun[] = []) => {\n      const existingIndex = oldData.findIndex(run => run.id === updatedRun.id);\n      \n      if (existingIndex >= 0) {\n        // Update existing run\n        const newData = [...oldData];\n        newData[existingIndex] = updatedRun;\n        return newData;\n      } else {\n        // Add new run (if within limit)\n        return [updatedRun, ...oldData.slice(0, maxRuns - 1)];\n      }\n    });\n  }, [queryClient, selectedPipeline, maxRuns]);\n\n  const handleRunCreated = useCallback((newRun: PipelineRun) => {\n    handleRunUpdate(newRun);\n  }, [handleRunUpdate]);\n\n  useEffect(() => {\n    if (!socket || !isConnected) return;\n\n    // Subscribe to pipeline execution events\n    socket.on('pipeline:run:updated', handleRunUpdate);\n    socket.on('pipeline:run:created', handleRunCreated);\n    socket.on('pipeline:run:status_changed', handleRunUpdate);\n\n    // Join pipeline-specific rooms if filtering\n    if (selectedPipeline !== 'all') {\n      socket.emit('subscribe:pipeline', selectedPipeline);\n    } else {\n      socket.emit('subscribe:all_pipelines');\n    }\n\n    return () => {\n      socket.off('pipeline:run:updated', handleRunUpdate);\n      socket.off('pipeline:run:created', handleRunCreated);\n      socket.off('pipeline:run:status_changed', handleRunUpdate);\n    };\n  }, [socket, isConnected, selectedPipeline, handleRunUpdate, handleRunCreated]);\n\n  // Toggle run expansion\n  const toggleRunExpansion = useCallback((runId: number) => {\n    setExpandedRuns(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(runId)) {\n        newSet.delete(runId);\n      } else {\n        newSet.add(runId);\n      }\n      return newSet;\n    });\n  }, []);\n\n  // Filter pipelines for dropdown\n  const pipelineOptions = useMemo(() => [\n    { value: 'all', label: 'All Pipelines' },\n    ...pipelines.map((p: Pipeline) => ({ value: p.id, label: p.name }))\n  ], [pipelines]);\n\n  const isLoading = pipelinesLoading || runsLoading;\n  const hasError = runsError || wsError;\n\n  return (\n    <div className={`space-y-6 ${className}`}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center gap-2\">\n            <Activity className=\"h-6 w-6\" />\n            Pipeline Execution\n          </h2>\n          <p className=\"text-gray-600 mt-1\">\n            Real-time view of pipeline executions\n            {isConnected && (\n              <span className=\"ml-2 inline-flex items-center gap-1 text-green-600\">\n                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n                Live\n              </span>\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          {/* Pipeline filter */}\n          <select\n            value={selectedPipeline}\n            onChange={(e) => setSelectedPipeline(e.target.value === 'all' ? 'all' : Number(e.target.value))}\n            className=\"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            {pipelineOptions.map(option => (\n              <option key={option.value} value={option.value}>\n                {option.label}\n              </option>\n            ))}\n          </select>\n\n          {/* Connection status */}\n          {autoRefresh && (\n            <div className={`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${\n              isConnected \n                ? 'bg-green-100 text-green-700' \n                : 'bg-yellow-100 text-yellow-700'\n            }`}>\n              <div className={`w-2 h-2 rounded-full ${\n                isConnected ? 'bg-green-500' : 'bg-yellow-500'\n              }`} />\n              {isConnected ? 'Connected' : 'Connecting...'}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Error state */}\n      {hasError && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n          <div className=\"flex items-center gap-2 text-red-800\">\n            <AlertCircle className=\"h-5 w-5\" />\n            <span className=\"font-medium\">Error loading pipeline data</span>\n          </div>\n          <p className=\"text-red-700 mt-1 text-sm\">\n            {runsError?.message || wsError || 'Failed to connect to real-time updates'}\n          </p>\n        </div>\n      )}\n\n      {/* Loading state */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-8\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-gray-400\" />\n          <span className=\"ml-2 text-gray-600\">Loading pipeline executions...</span>\n        </div>\n      )}\n\n      {/* Pipeline runs */}\n      {!isLoading && runs.length > 0 && (\n        <div className=\"space-y-4\">\n          {runs.map((run: PipelineRun) => {\n            const pipeline = pipelines.find((p: Pipeline) => p.id === run.pipeline_id);\n            if (!pipeline) return null;\n\n            return (\n              <PipelineRunItem\n                key={run.id}\n                run={run}\n                pipeline={pipeline}\n                isExpanded={expandedRuns.has(run.id)}\n                onToggleExpand={() => toggleRunExpansion(run.id)}\n                showLogs={showLogs}\n              />\n            );\n          })}\n        </div>\n      )}\n\n      {/* Empty state */}\n      {!isLoading && runs.length === 0 && (\n        <div className=\"text-center py-8\">\n          <PlayCircle className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No pipeline executions</h3>\n          <p className=\"text-gray-600\">\n            {selectedPipeline === 'all' \n              ? 'No recent pipeline executions found.' \n              : 'No recent executions for the selected pipeline.'\n            }\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PipelineExecutionView; "],"names":["PipelineExecutionView","useWebSocket","url","options","socket","setSocket","useState","isConnected","setIsConnected","error","setError","useEffect","enabled","socketInstance","io","transports","timeout","retries","ackTimeout","on","console","log","reason","details","message","disconnect","StatusBadge","status","size","statusConfig","pending","icon","Clock","color","label","running","Loader2","success","CheckCircle","failure","XCircle","cancelled","AlertCircle","skipped","config","Icon","sizeClasses","span","className","Duration","startedAt","finishedAt","isRunning","currentTime","setCurrentTime","Date","now","interval","setInterval","clearInterval","duration","useMemo","start","getTime","end","diffInSeconds","Math","floor","minutes","seconds","Timer","PipelineRunItem","run","pipeline","isExpanded","onToggleExpand","showLogs","hasSteps","steps","length","div","h3","name","run_number","p","commit_message","started_at","finished_at","button","onClick","RefreshCw","GitBranch","branch","User","triggered_by","Calendar","formatDistanceToNow","addSuffix","Zap","trigger_event","h4","map","step","duration_seconds","id","logs","slice","index","maxRuns","autoRefresh","expandedRuns","setExpandedRuns","Set","selectedPipeline","setSelectedPipeline","queryClient","useQueryClient","wsError","process","env","NEXT_PUBLIC_WS_URL","data","pipelines","isLoading","pipelinesLoading","useQuery","queryKey","queryFn","response","fetch","ok","Error","json","staleTime","runs","runsLoading","runsError","params","URLSearchParams","limit","toString","pipeline_id","refetchInterval","handleRunUpdate","useCallback","updatedRun","setQueryData","oldData","existingIndex","findIndex","newData","handleRunCreated","newRun","emit","off","toggleRunExpansion","runId","prev","newSet","has","delete","add","pipelineOptions","value","hasError","h2","Activity","select","onChange","e","target","Number","option","find","PlayCircle"],"mappings":"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"}
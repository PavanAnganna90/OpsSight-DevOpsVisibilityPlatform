998147fb35f5879c2933dbab65ff004f
/**
 * Permission Guard Component
 * 
 * Conditionally renders children based on user permissions
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    AdminOnly: function() {
        return AdminOnly;
    },
    PermissionGuard: function() {
        return PermissionGuard;
    },
    ResourceGuard: function() {
        return ResourceGuard;
    },
    RoleGuard: function() {
        return RoleGuard;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _AuthContext = require("../../contexts/AuthContext");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function PermissionGuard({ permission, permissions, role, roles, resource, action, organizationId, requireAll = false, fallback = null, children }) {
    const { hasPermission, hasRole, hasAnyRole, hasAnyPermission, canAccess } = (0, _AuthContext.useAuth)();
    // Check permissions
    let hasAccess = true;
    // Single permission check
    if (permission) {
        hasAccess = hasPermission(permission, organizationId);
    }
    // Multiple permissions check
    if (permissions && permissions.length > 0) {
        hasAccess = requireAll ? permissions.every((p)=>hasPermission(p, organizationId)) : hasAnyPermission(permissions);
    }
    // Single role check
    if (role) {
        hasAccess = hasAccess && hasRole(role);
    }
    // Multiple roles check
    if (roles && roles.length > 0) {
        hasAccess = hasAccess && (requireAll ? roles.every((r)=>hasRole(r)) : hasAnyRole(roles));
    }
    // Resource/action check
    if (resource && action) {
        hasAccess = hasAccess && canAccess(resource, action, organizationId);
    }
    return hasAccess ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
        children: children
    }) : /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
        children: fallback
    });
}
function AdminOnly({ children, fallback = null }) {
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(PermissionGuard, {
        roles: [
            'admin',
            'organization_owner',
            'super_admin'
        ],
        fallback: fallback,
        children: children
    });
}
function RoleGuard({ role, roles, children, fallback = null }) {
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(PermissionGuard, {
        role: role,
        roles: roles,
        fallback: fallback,
        children: children
    });
}
function ResourceGuard({ resource, action, organizationId, children, fallback = null }) {
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(PermissionGuard, {
        resource: resource,
        action: action,
        organizationId: organizationId,
        fallback: fallback,
        children: children
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9wYXZhbi9EZXNrdG9wL0Rldm9wcy1hcHAtZGV2LWN1cnNvci9mcm9udGVuZC9zcmMvY29tcG9uZW50cy9yYmFjL1Blcm1pc3Npb25HdWFyZC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQZXJtaXNzaW9uIEd1YXJkIENvbXBvbmVudFxuICogXG4gKiBDb25kaXRpb25hbGx5IHJlbmRlcnMgY2hpbGRyZW4gYmFzZWQgb24gdXNlciBwZXJtaXNzaW9uc1xuICovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9jb250ZXh0cy9BdXRoQ29udGV4dCc7XG5cbmludGVyZmFjZSBQZXJtaXNzaW9uR3VhcmRQcm9wcyB7XG4gIHBlcm1pc3Npb24/OiBzdHJpbmc7XG4gIHBlcm1pc3Npb25zPzogc3RyaW5nW107XG4gIHJvbGU/OiBzdHJpbmc7XG4gIHJvbGVzPzogc3RyaW5nW107XG4gIHJlc291cmNlPzogc3RyaW5nO1xuICBhY3Rpb24/OiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkPzogc3RyaW5nO1xuICByZXF1aXJlQWxsPzogYm9vbGVhbjtcbiAgZmFsbGJhY2s/OiBSZWFjdC5SZWFjdE5vZGU7XG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQZXJtaXNzaW9uR3VhcmQoe1xuICBwZXJtaXNzaW9uLFxuICBwZXJtaXNzaW9ucyxcbiAgcm9sZSxcbiAgcm9sZXMsXG4gIHJlc291cmNlLFxuICBhY3Rpb24sXG4gIG9yZ2FuaXphdGlvbklkLFxuICByZXF1aXJlQWxsID0gZmFsc2UsXG4gIGZhbGxiYWNrID0gbnVsbCxcbiAgY2hpbGRyZW4sXG59OiBQZXJtaXNzaW9uR3VhcmRQcm9wcykge1xuICBjb25zdCB7IGhhc1Blcm1pc3Npb24sIGhhc1JvbGUsIGhhc0FueVJvbGUsIGhhc0FueVBlcm1pc3Npb24sIGNhbkFjY2VzcyB9ID0gdXNlQXV0aCgpO1xuXG4gIC8vIENoZWNrIHBlcm1pc3Npb25zXG4gIGxldCBoYXNBY2Nlc3MgPSB0cnVlO1xuXG4gIC8vIFNpbmdsZSBwZXJtaXNzaW9uIGNoZWNrXG4gIGlmIChwZXJtaXNzaW9uKSB7XG4gICAgaGFzQWNjZXNzID0gaGFzUGVybWlzc2lvbihwZXJtaXNzaW9uLCBvcmdhbml6YXRpb25JZCk7XG4gIH1cblxuICAvLyBNdWx0aXBsZSBwZXJtaXNzaW9ucyBjaGVja1xuICBpZiAocGVybWlzc2lvbnMgJiYgcGVybWlzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgIGhhc0FjY2VzcyA9IHJlcXVpcmVBbGwgXG4gICAgICA/IHBlcm1pc3Npb25zLmV2ZXJ5KHAgPT4gaGFzUGVybWlzc2lvbihwLCBvcmdhbml6YXRpb25JZCkpXG4gICAgICA6IGhhc0FueVBlcm1pc3Npb24ocGVybWlzc2lvbnMpO1xuICB9XG5cbiAgLy8gU2luZ2xlIHJvbGUgY2hlY2tcbiAgaWYgKHJvbGUpIHtcbiAgICBoYXNBY2Nlc3MgPSBoYXNBY2Nlc3MgJiYgaGFzUm9sZShyb2xlKTtcbiAgfVxuXG4gIC8vIE11bHRpcGxlIHJvbGVzIGNoZWNrXG4gIGlmIChyb2xlcyAmJiByb2xlcy5sZW5ndGggPiAwKSB7XG4gICAgaGFzQWNjZXNzID0gaGFzQWNjZXNzICYmIChyZXF1aXJlQWxsIFxuICAgICAgPyByb2xlcy5ldmVyeShyID0+IGhhc1JvbGUocikpXG4gICAgICA6IGhhc0FueVJvbGUocm9sZXMpKTtcbiAgfVxuXG4gIC8vIFJlc291cmNlL2FjdGlvbiBjaGVja1xuICBpZiAocmVzb3VyY2UgJiYgYWN0aW9uKSB7XG4gICAgaGFzQWNjZXNzID0gaGFzQWNjZXNzICYmIGNhbkFjY2VzcyhyZXNvdXJjZSwgYWN0aW9uLCBvcmdhbml6YXRpb25JZCk7XG4gIH1cblxuICByZXR1cm4gaGFzQWNjZXNzID8gPD57Y2hpbGRyZW59PC8+IDogPD57ZmFsbGJhY2t9PC8+O1xufVxuXG4vLyBDb252ZW5pZW5jZSBjb21wb25lbnRzIGZvciBjb21tb24gdXNlIGNhc2VzXG5leHBvcnQgZnVuY3Rpb24gQWRtaW5Pbmx5KHsgY2hpbGRyZW4sIGZhbGxiYWNrID0gbnVsbCB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7IGZhbGxiYWNrPzogUmVhY3QuUmVhY3ROb2RlIH0pIHtcbiAgcmV0dXJuIChcbiAgICA8UGVybWlzc2lvbkd1YXJkIHJvbGVzPXtbJ2FkbWluJywgJ29yZ2FuaXphdGlvbl9vd25lcicsICdzdXBlcl9hZG1pbiddfSBmYWxsYmFjaz17ZmFsbGJhY2t9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvUGVybWlzc2lvbkd1YXJkPlxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gUm9sZUd1YXJkKHsgXG4gIHJvbGUsIFxuICByb2xlcywgXG4gIGNoaWxkcmVuLCBcbiAgZmFsbGJhY2sgPSBudWxsIFxufTogeyBcbiAgcm9sZT86IHN0cmluZzsgXG4gIHJvbGVzPzogc3RyaW5nW107IFxuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlOyBcbiAgZmFsbGJhY2s/OiBSZWFjdC5SZWFjdE5vZGUgXG59KSB7XG4gIHJldHVybiAoXG4gICAgPFBlcm1pc3Npb25HdWFyZCByb2xlPXtyb2xlfSByb2xlcz17cm9sZXN9IGZhbGxiYWNrPXtmYWxsYmFja30+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9QZXJtaXNzaW9uR3VhcmQ+XG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBSZXNvdXJjZUd1YXJkKHsgXG4gIHJlc291cmNlLCBcbiAgYWN0aW9uLCBcbiAgb3JnYW5pemF0aW9uSWQsIFxuICBjaGlsZHJlbiwgXG4gIGZhbGxiYWNrID0gbnVsbCBcbn06IHsgXG4gIHJlc291cmNlOiBzdHJpbmc7IFxuICBhY3Rpb246IHN0cmluZzsgXG4gIG9yZ2FuaXphdGlvbklkPzogc3RyaW5nOyBcbiAgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZTsgXG4gIGZhbGxiYWNrPzogUmVhY3QuUmVhY3ROb2RlIFxufSkge1xuICByZXR1cm4gKFxuICAgIDxQZXJtaXNzaW9uR3VhcmQgcmVzb3VyY2U9e3Jlc291cmNlfSBhY3Rpb249e2FjdGlvbn0gb3JnYW5pemF0aW9uSWQ9e29yZ2FuaXphdGlvbklkfSBmYWxsYmFjaz17ZmFsbGJhY2t9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvUGVybWlzc2lvbkd1YXJkPlxuICApO1xufSJdLCJuYW1lcyI6WyJBZG1pbk9ubHkiLCJQZXJtaXNzaW9uR3VhcmQiLCJSZXNvdXJjZUd1YXJkIiwiUm9sZUd1YXJkIiwicGVybWlzc2lvbiIsInBlcm1pc3Npb25zIiwicm9sZSIsInJvbGVzIiwicmVzb3VyY2UiLCJhY3Rpb24iLCJvcmdhbml6YXRpb25JZCIsInJlcXVpcmVBbGwiLCJmYWxsYmFjayIsImNoaWxkcmVuIiwiaGFzUGVybWlzc2lvbiIsImhhc1JvbGUiLCJoYXNBbnlSb2xlIiwiaGFzQW55UGVybWlzc2lvbiIsImNhbkFjY2VzcyIsInVzZUF1dGgiLCJoYXNBY2Nlc3MiLCJsZW5ndGgiLCJldmVyeSIsInAiLCJyIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztDQUlDOzs7Ozs7Ozs7OztJQW9FZUEsU0FBUztlQUFUQTs7SUFsREFDLGVBQWU7ZUFBZkE7O0lBNEVBQyxhQUFhO2VBQWJBOztJQWxCQUMsU0FBUztlQUFUQTs7Ozs4REExRUU7NkJBQ007Ozs7OztBQWVqQixTQUFTRixnQkFBZ0IsRUFDOUJHLFVBQVUsRUFDVkMsV0FBVyxFQUNYQyxJQUFJLEVBQ0pDLEtBQUssRUFDTEMsUUFBUSxFQUNSQyxNQUFNLEVBQ05DLGNBQWMsRUFDZEMsYUFBYSxLQUFLLEVBQ2xCQyxXQUFXLElBQUksRUFDZkMsUUFBUSxFQUNhO0lBQ3JCLE1BQU0sRUFBRUMsYUFBYSxFQUFFQyxPQUFPLEVBQUVDLFVBQVUsRUFBRUMsZ0JBQWdCLEVBQUVDLFNBQVMsRUFBRSxHQUFHQyxJQUFBQSxvQkFBTztJQUVuRixvQkFBb0I7SUFDcEIsSUFBSUMsWUFBWTtJQUVoQiwwQkFBMEI7SUFDMUIsSUFBSWhCLFlBQVk7UUFDZGdCLFlBQVlOLGNBQWNWLFlBQVlNO0lBQ3hDO0lBRUEsNkJBQTZCO0lBQzdCLElBQUlMLGVBQWVBLFlBQVlnQixNQUFNLEdBQUcsR0FBRztRQUN6Q0QsWUFBWVQsYUFDUk4sWUFBWWlCLEtBQUssQ0FBQ0MsQ0FBQUEsSUFBS1QsY0FBY1MsR0FBR2IsbUJBQ3hDTyxpQkFBaUJaO0lBQ3ZCO0lBRUEsb0JBQW9CO0lBQ3BCLElBQUlDLE1BQU07UUFDUmMsWUFBWUEsYUFBYUwsUUFBUVQ7SUFDbkM7SUFFQSx1QkFBdUI7SUFDdkIsSUFBSUMsU0FBU0EsTUFBTWMsTUFBTSxHQUFHLEdBQUc7UUFDN0JELFlBQVlBLGFBQWNULENBQUFBLGFBQ3RCSixNQUFNZSxLQUFLLENBQUNFLENBQUFBLElBQUtULFFBQVFTLE1BQ3pCUixXQUFXVCxNQUFLO0lBQ3RCO0lBRUEsd0JBQXdCO0lBQ3hCLElBQUlDLFlBQVlDLFFBQVE7UUFDdEJXLFlBQVlBLGFBQWFGLFVBQVVWLFVBQVVDLFFBQVFDO0lBQ3ZEO0lBRUEsT0FBT1UsMEJBQVk7a0JBQUdQO3VCQUFlO2tCQUFHRDs7QUFDMUM7QUFHTyxTQUFTWixVQUFVLEVBQUVhLFFBQVEsRUFBRUQsV0FBVyxJQUFJLEVBQTZEO0lBQ2hILHFCQUNFLHFCQUFDWDtRQUFnQk0sT0FBTztZQUFDO1lBQVM7WUFBc0I7U0FBYztRQUFFSyxVQUFVQTtrQkFDL0VDOztBQUdQO0FBRU8sU0FBU1YsVUFBVSxFQUN4QkcsSUFBSSxFQUNKQyxLQUFLLEVBQ0xNLFFBQVEsRUFDUkQsV0FBVyxJQUFJLEVBTWhCO0lBQ0MscUJBQ0UscUJBQUNYO1FBQWdCSyxNQUFNQTtRQUFNQyxPQUFPQTtRQUFPSyxVQUFVQTtrQkFDbERDOztBQUdQO0FBRU8sU0FBU1gsY0FBYyxFQUM1Qk0sUUFBUSxFQUNSQyxNQUFNLEVBQ05DLGNBQWMsRUFDZEcsUUFBUSxFQUNSRCxXQUFXLElBQUksRUFPaEI7SUFDQyxxQkFDRSxxQkFBQ1g7UUFBZ0JPLFVBQVVBO1FBQVVDLFFBQVFBO1FBQVFDLGdCQUFnQkE7UUFBZ0JFLFVBQVVBO2tCQUM1RkM7O0FBR1AifQ==
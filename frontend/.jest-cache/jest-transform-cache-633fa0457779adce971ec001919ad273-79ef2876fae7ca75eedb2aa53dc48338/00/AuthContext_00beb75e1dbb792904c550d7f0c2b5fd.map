{"version":3,"names":["cov_12bdk279uk","actualCoverage","s","AuthProvider","f","default","_default","useAuth","initialState","isAuthenticated","isLoading","user","tokens","error","authReducer","state","action","type","b","payload","AuthContext","_react","createContext","undefined","STORAGE_KEYS","ACCESS_TOKEN","REFRESH_TOKEN","USER_DATA","API_BASE_URL","process","env","NEXT_PUBLIC_API_BASE_URL","children","dispatch","useReducer","useEffect","initializeAuth","accessToken","localStorage","getItem","refreshToken","userData","JSON","parse","access_token","refresh_token","token_type","getCurrentUser","clearStoredAuth","removeItem","storeAuthData","setItem","stringify","authenticatedFetch","url","options","Error","response","fetch","headers","status","refreshError","logout","login","code","state_param","method","body","ok","json","detail","userResponse","message","console","warn","contextValue","_jsxruntime","jsx","Provider","value","context","useContext"],"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["/**\n * Authentication context for managing user session state.\n * Provides authentication state, user data, and auth methods to components.\n */\n'use client';\n\nimport React, { createContext, useContext, useReducer, useEffect, ReactNode } from 'react';\nimport { \n  APIError, \n  NetworkError, \n  TokenError, \n  ErrorLogger,\n  AppError,\n  ErrorType,\n  handleFetchError,\n  createNetworkError \n} from '../utils/errorHandling';\nimport { \n  TokenSecurity, \n  CSRFProtection,\n  InputValidator,\n  RateLimiter \n} from '../utils/security';\n\n// Types for authentication state\ninterface User {\n  id: number;\n  github_id: string;\n  github_username: string;\n  email: string | null;\n  full_name: string | null;\n  avatar_url: string | null;\n  bio: string | null;\n  company: string | null;\n  location: string | null;\n  blog: string | null;\n  is_active: boolean;\n  is_superuser: boolean;\n  created_at: string | null;\n  updated_at: string | null;\n  last_login: string | null;\n}\n\ninterface AuthTokens {\n  access_token: string;\n  refresh_token?: string;\n  token_type: string;\n  expires_in?: number;\n}\n\ninterface AuthState {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  user: User | null;\n  tokens: AuthTokens | null;\n  error: string | null;\n}\n\n// Auth action types\ntype AuthAction =\n  | { type: 'AUTH_START' }\n  | { type: 'AUTH_SUCCESS'; payload: { user: User; tokens: AuthTokens } }\n  | { type: 'AUTH_FAILURE'; payload: string }\n  | { type: 'AUTH_LOGOUT' }\n  | { type: 'AUTH_REFRESH_SUCCESS'; payload: AuthTokens }\n  | { type: 'AUTH_UPDATE_USER'; payload: User };\n\n// Auth context interface\ninterface AuthContextType {\n  state: AuthState;\n  login: (code: string, state?: string) => Promise<void>;\n  logout: () => Promise<void>;\n  refreshToken: () => Promise<void>;\n  getCurrentUser: () => Promise<void>;\n}\n\n// Initial state\nconst initialState: AuthState = {\n  isAuthenticated: false,\n  isLoading: false,\n  user: null,\n  tokens: null,\n  error: null,\n};\n\n// Auth reducer\nfunction authReducer(state: AuthState, action: AuthAction): AuthState {\n  switch (action.type) {\n    case 'AUTH_START':\n      return {\n        ...state,\n        isLoading: true,\n        error: null,\n      };\n    case 'AUTH_SUCCESS':\n      return {\n        ...state,\n        isAuthenticated: true,\n        isLoading: false,\n        user: action.payload.user,\n        tokens: action.payload.tokens,\n        error: null,\n      };\n    case 'AUTH_FAILURE':\n      return {\n        ...state,\n        isAuthenticated: false,\n        isLoading: false,\n        user: null,\n        tokens: null,\n        error: action.payload,\n      };\n    case 'AUTH_LOGOUT':\n      return {\n        ...initialState,\n      };\n    case 'AUTH_REFRESH_SUCCESS':\n      return {\n        ...state,\n        tokens: action.payload,\n        error: null,\n      };\n    case 'AUTH_UPDATE_USER':\n      return {\n        ...state,\n        user: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n\n// Create context\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\n// Storage keys\nconst STORAGE_KEYS = {\n  ACCESS_TOKEN: 'opsight_access_token',\n  REFRESH_TOKEN: 'opsight_refresh_token',\n  USER_DATA: 'opsight_user_data',\n} as const;\n\n// API base URL - Use process.env for Jest compatibility\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8000/api/v1';\n\n/**\n * Authentication Provider Component\n * \n * Manages authentication state and provides auth methods to child components.\n * Handles token persistence, automatic refresh, and session restoration.\n * \n * @param children - Child components that need access to auth context\n */\nexport const AuthProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  /**\n   * Initialize authentication state from stored tokens on app start.\n   */\n  useEffect(() => {\n    const initializeAuth = async () => {\n      const accessToken = localStorage.getItem(STORAGE_KEYS.ACCESS_TOKEN);\n      const refreshToken = localStorage.getItem(STORAGE_KEYS.REFRESH_TOKEN);\n      const userData = localStorage.getItem(STORAGE_KEYS.USER_DATA);\n\n      if (accessToken && userData) {\n        try {\n          const user = JSON.parse(userData);\n          const tokens = {\n            access_token: accessToken,\n            refresh_token: refreshToken || undefined,\n            token_type: 'bearer',\n          };\n\n          dispatch({\n            type: 'AUTH_SUCCESS',\n            payload: { user, tokens },\n          });\n\n          // Verify token is still valid by fetching current user\n          await getCurrentUser();\n        } catch (error) {\n          // Reason: Clear invalid stored data\n          clearStoredAuth();\n        }\n      }\n    };\n\n    initializeAuth();\n  }, []);\n\n  /**\n   * Clear stored authentication data from localStorage.\n   */\n  const clearStoredAuth = (): void => {\n    localStorage.removeItem(STORAGE_KEYS.ACCESS_TOKEN);\n    localStorage.removeItem(STORAGE_KEYS.REFRESH_TOKEN);\n    localStorage.removeItem(STORAGE_KEYS.USER_DATA);\n  };\n\n  /**\n   * Store authentication data in localStorage.\n   */\n  const storeAuthData = (user: User, tokens: AuthTokens): void => {\n    localStorage.setItem(STORAGE_KEYS.ACCESS_TOKEN, tokens.access_token);\n    if (tokens.refresh_token) {\n      localStorage.setItem(STORAGE_KEYS.REFRESH_TOKEN, tokens.refresh_token);\n    }\n    localStorage.setItem(STORAGE_KEYS.USER_DATA, JSON.stringify(user));\n  };\n\n  /**\n   * Make authenticated API request with automatic token refresh.\n   */\n  const authenticatedFetch = async (\n    url: string,\n    options: RequestInit = {}\n  ): Promise<Response> => {\n    const accessToken = state.tokens?.access_token;\n    \n    if (!accessToken) {\n      throw new Error('No access token available');\n    }\n\n    const response = await fetch(url, {\n      ...options,\n      headers: {\n        ...options.headers,\n        'Authorization': `Bearer ${accessToken}`,\n        'Content-Type': 'application/json',\n      },\n    });\n\n    // If token expired, try to refresh\n    if (response.status === 401 && state.tokens?.refresh_token) {\n      try {\n        await refreshToken();\n        // Retry the request with new token\n        return fetch(url, {\n          ...options,\n          headers: {\n            ...options.headers,\n            'Authorization': `Bearer ${state.tokens?.access_token}`,\n            'Content-Type': 'application/json',\n          },\n        });\n      } catch (refreshError) {\n        // Refresh failed, logout user\n        await logout();\n        throw new Error('Session expired. Please log in again.');\n      }\n    }\n\n    return response;\n  };\n\n  /**\n   * Login with GitHub OAuth code.\n   */\n  const login = async (code: string, state_param?: string): Promise<void> => {\n    dispatch({ type: 'AUTH_START' });\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/auth/login/github`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          code,\n          state: state_param,\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.detail || 'Login failed');\n      }\n\n      const tokens: AuthTokens = await response.json();\n\n      // Get user data\n      const userResponse = await fetch(`${API_BASE_URL}/auth/me`, {\n        headers: {\n          'Authorization': `Bearer ${tokens.access_token}`,\n        },\n      });\n\n      if (!userResponse.ok) {\n        throw new Error('Failed to fetch user data');\n      }\n\n      const user: User = await userResponse.json();\n\n      // Store auth data\n      storeAuthData(user, tokens);\n\n      dispatch({\n        type: 'AUTH_SUCCESS',\n        payload: { user, tokens },\n      });\n    } catch (error) {\n      const message = error instanceof Error ? error.message : 'Login failed';\n      dispatch({ type: 'AUTH_FAILURE', payload: message });\n      throw error;\n    }\n  };\n\n  /**\n   * Logout current user.\n   */\n  const logout = async (): Promise<void> => {\n    try {\n      // Call logout endpoint if authenticated\n      if (state.tokens?.access_token) {\n        await authenticatedFetch(`${API_BASE_URL}/auth/logout`, {\n          method: 'POST',\n        });\n      }\n    } catch (error) {\n      // Log error but continue with logout\n      console.warn('Logout API call failed:', error);\n    } finally {\n      // Always clear local state and storage\n      clearStoredAuth();\n      dispatch({ type: 'AUTH_LOGOUT' });\n    }\n  };\n\n  /**\n   * Refresh access token using refresh token.\n   */\n  const refreshToken = async (): Promise<void> => {\n    const refresh_token = state.tokens?.refresh_token;\n    \n    if (!refresh_token) {\n      throw new Error('No refresh token available');\n    }\n\n    try {\n      const response = await fetch(`${API_BASE_URL}/auth/refresh`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          refresh_token,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Token refresh failed');\n      }\n\n      const tokens: AuthTokens = await response.json();\n\n      // Update stored tokens\n      localStorage.setItem(STORAGE_KEYS.ACCESS_TOKEN, tokens.access_token);\n      if (tokens.refresh_token) {\n        localStorage.setItem(STORAGE_KEYS.REFRESH_TOKEN, tokens.refresh_token);\n      }\n\n      dispatch({\n        type: 'AUTH_REFRESH_SUCCESS',\n        payload: tokens,\n      });\n    } catch (error) {\n      // Refresh failed, logout user\n      await logout();\n      throw error;\n    }\n  };\n\n  /**\n   * Get current user data from API.\n   */\n  const getCurrentUser = async (): Promise<void> => {\n    try {\n      const response = await authenticatedFetch(`${API_BASE_URL}/auth/me`);\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch user data');\n      }\n\n      const user: User = await response.json();\n\n      // Update stored user data\n      localStorage.setItem(STORAGE_KEYS.USER_DATA, JSON.stringify(user));\n\n      dispatch({\n        type: 'AUTH_UPDATE_USER',\n        payload: user,\n      });\n    } catch (error) {\n      console.error('Failed to get current user:', error);\n      throw error;\n    }\n  };\n\n  const contextValue: AuthContextType = {\n    state,\n    login,\n    logout,\n    refreshToken,\n    getCurrentUser,\n  };\n\n  return (\n    <AuthContext.Provider value={contextValue}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n/**\n * Hook to access authentication context.\n * \n * @returns AuthContextType - Authentication state and methods\n * @throws Error if used outside AuthProvider\n */\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  \n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  \n  return context;\n};\n\nexport default AuthContext; "],"mappings":"AAAA;;;GAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
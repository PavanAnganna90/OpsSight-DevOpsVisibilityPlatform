{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/dashboard/SystemPulsePanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useContext, useEffect } from 'react';\nimport AnimatedIllustration from '../ui/AnimatedIllustration';\nimport StatusIndicator from '../ui/StatusIndicator';\nimport EmptyState from '../ui/EmptyState';\nimport { useSystemMetrics } from '../../hooks/useSystemMetrics';\nimport { trackEvent } from '../../utils/analytics';\nimport type { StatusType } from '../ui/StatusIndicator';\nimport { useSettings } from '../../contexts/SettingsContext';\n// import { SettingsContext } from '../../contexts/SettingsContext'; // Uncomment when context is ready\n\ninterface Metric {\n  id: string;\n  title: string;\n  status: string;\n  value: string;\n  detail: string;\n}\n\n/**\n * Left panel component displaying system health signals.\n * Shows key metrics with color-coded status indicators.\n */\nexport default function SystemPulsePanel() {\n  // const { refreshInterval } = useContext(SettingsContext) || { refreshInterval: 0 };\n  const { data, isLoading, error, refetch } = useSystemMetrics();\n  const [showUnhealthy, setShowUnhealthy] = React.useState(false);\n  const { panelVisibility, refreshInterval } = useSettings();\n\n  // Hide panel if not visible\n  if (!panelVisibility.systemPulse) return null;\n\n  // Auto-refresh logic\n  useEffect(() => {\n    if (refreshInterval > 0) {\n      const interval = setInterval(() => {\n        trackEvent('auto-refresh', { panel: 'SystemPulse' });\n        refetch();\n      }, refreshInterval * 1000);\n      return () => clearInterval(interval);\n    }\n  }, [refreshInterval, refetch]);\n\n  const handleRefresh = async () => {\n    trackEvent('refresh', { panel: 'SystemPulse' });\n    await refetch();\n  };\n\n  let metrics: Metric[] = Array.isArray(data) ? data : [];\n  const filteredMetrics = showUnhealthy\n    ? metrics.filter(m => m.status !== 'success')\n    : metrics;\n\n  if (isLoading) {\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500 mb-2\" aria-label=\"Loading system metrics\" />\n        <span className=\"text-gray-500\">Loading system metrics...</span>\n      </section>\n    );\n  }\n\n  if (error) {\n    trackEvent('error', { panel: 'SystemPulse', error: String(error) });\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"Error Loading Metrics\"\n          description=\"We couldn't load your system metrics. Please try again.\"\n          action={{ label: 'Retry', onClick: handleRefresh }}\n        />\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 relative overflow-hidden min-h-[320px]\">\n      {/* Panel Controls */}\n      <div className=\"flex items-center justify-between mb-2\">\n        <label className=\"flex items-center gap-2 text-sm cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={showUnhealthy}\n            onChange={e => setShowUnhealthy(e.target.checked)}\n            className=\"accent-blue-500\"\n            aria-label=\"Show only unhealthy systems\"\n          />\n          Show only unhealthy systems\n        </label>\n        <div className=\"flex items-center gap-2\">\n          {refreshInterval > 0 && (\n            <span className=\"text-xs text-blue-400\" title=\"Auto-refresh enabled\">\n              Auto-refresh: {refreshInterval}s\n            </span>\n          )}\n          <button\n            onClick={handleRefresh}\n            className=\"px-3 py-1 rounded bg-blue-500 text-white font-medium hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 transition\"\n          >\n            Refresh\n          </button>\n        </div>\n      </div>\n      {/* Metrics or Empty State */}\n      {filteredMetrics.length === 0 ? (\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"No System Metrics\"\n          description=\"Everything is quiet. Enjoy your coffee â˜•\"\n          action={{ label: 'Refresh', onClick: handleRefresh }}\n        />\n      ) : (\n        <div className=\"flex flex-col gap-4\">\n          {filteredMetrics.map(metric => (\n            <div key={metric.id} className=\"relative flex items-center gap-4 group hover:bg-blue-50 dark:hover:bg-blue-900/20 transition rounded-lg p-4\">\n              <AnimatedIllustration\n                name={metric.id === 'cicd' ? 'pipeline' : metric.id === 'k8s' ? 'k8s' : 'cloud'}\n                className=\"absolute right-2 bottom-2 w-20 h-20 opacity-15 pointer-events-none group-hover:scale-105 transition-transform duration-300\"\n                alt={metric.title}\n              />\n              <StatusIndicator status={metric.status as StatusType} />\n              <div className=\"z-10\">\n                <div className=\"font-medium\">{metric.title}</div>\n                <div className=\"text-xs text-gray-500\">{metric.value}</div>\n                {metric.detail && <div className=\"text-xs text-blue-400 mt-1\">{metric.detail}</div>}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </section>\n  );\n} "],"names":["SystemPulsePanel","data","isLoading","error","refetch","useSystemMetrics","showUnhealthy","setShowUnhealthy","React","useState","panelVisibility","refreshInterval","useSettings","systemPulse","useEffect","interval","setInterval","trackEvent","panel","clearInterval","handleRefresh","metrics","Array","isArray","filteredMetrics","filter","m","status","section","className","div","aria-label","span","String","EmptyState","illustration","title","description","action","label","onClick","input","type","checked","onChange","e","target","button","length","map","metric","AnimatedIllustration","name","id","alt","StatusIndicator","value","detail"],"mappings":"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"}
{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/rbac/PermissionGuard.tsx"],"sourcesContent":["/**\n * Permission Guard Component\n * \n * Conditionally renders children based on user permissions\n */\n\nimport React from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\n\ninterface PermissionGuardProps {\n  permission?: string;\n  permissions?: string[];\n  role?: string;\n  roles?: string[];\n  resource?: string;\n  action?: string;\n  organizationId?: string;\n  requireAll?: boolean;\n  fallback?: React.ReactNode;\n  children: React.ReactNode;\n}\n\nexport function PermissionGuard({\n  permission,\n  permissions,\n  role,\n  roles,\n  resource,\n  action,\n  organizationId,\n  requireAll = false,\n  fallback = null,\n  children,\n}: PermissionGuardProps) {\n  const { hasPermission, hasRole, hasAnyRole, hasAnyPermission, canAccess } = useAuth();\n\n  // Check permissions\n  let hasAccess = true;\n\n  // Single permission check\n  if (permission) {\n    hasAccess = hasPermission(permission, organizationId);\n  }\n\n  // Multiple permissions check\n  if (permissions && permissions.length > 0) {\n    hasAccess = requireAll \n      ? permissions.every(p => hasPermission(p, organizationId))\n      : hasAnyPermission(permissions);\n  }\n\n  // Single role check\n  if (role) {\n    hasAccess = hasAccess && hasRole(role);\n  }\n\n  // Multiple roles check\n  if (roles && roles.length > 0) {\n    hasAccess = hasAccess && (requireAll \n      ? roles.every(r => hasRole(r))\n      : hasAnyRole(roles));\n  }\n\n  // Resource/action check\n  if (resource && action) {\n    hasAccess = hasAccess && canAccess(resource, action, organizationId);\n  }\n\n  return hasAccess ? <>{children}</> : <>{fallback}</>;\n}\n\n// Convenience components for common use cases\nexport function AdminOnly({ children, fallback = null }: { children: React.ReactNode; fallback?: React.ReactNode }) {\n  return (\n    <PermissionGuard roles={['admin', 'organization_owner', 'super_admin']} fallback={fallback}>\n      {children}\n    </PermissionGuard>\n  );\n}\n\nexport function RoleGuard({ \n  role, \n  roles, \n  children, \n  fallback = null \n}: { \n  role?: string; \n  roles?: string[]; \n  children: React.ReactNode; \n  fallback?: React.ReactNode \n}) {\n  return (\n    <PermissionGuard role={role} roles={roles} fallback={fallback}>\n      {children}\n    </PermissionGuard>\n  );\n}\n\nexport function ResourceGuard({ \n  resource, \n  action, \n  organizationId, \n  children, \n  fallback = null \n}: { \n  resource: string; \n  action: string; \n  organizationId?: string; \n  children: React.ReactNode; \n  fallback?: React.ReactNode \n}) {\n  return (\n    <PermissionGuard resource={resource} action={action} organizationId={organizationId} fallback={fallback}>\n      {children}\n    </PermissionGuard>\n  );\n}"],"names":["AdminOnly","PermissionGuard","ResourceGuard","RoleGuard","permission","permissions","role","roles","resource","action","organizationId","requireAll","fallback","children","hasPermission","hasRole","hasAnyRole","hasAnyPermission","canAccess","useAuth","hasAccess","length","every","p","r"],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;IAoEeA,SAAS;eAATA;;IAlDAC,eAAe;eAAfA;;IA4EAC,aAAa;eAAbA;;IAlBAC,SAAS;eAATA;;;;8DA1EE;6BACM;;;;;;AAejB,SAASF,gBAAgB,EAC9BG,UAAU,EACVC,WAAW,EACXC,IAAI,EACJC,KAAK,EACLC,QAAQ,EACRC,MAAM,EACNC,cAAc,EACdC,aAAa,KAAK,EAClBC,WAAW,IAAI,EACfC,QAAQ,EACa;IACrB,MAAM,EAAEC,aAAa,EAAEC,OAAO,EAAEC,UAAU,EAAEC,gBAAgB,EAAEC,SAAS,EAAE,GAAGC,IAAAA,oBAAO;IAEnF,oBAAoB;IACpB,IAAIC,YAAY;IAEhB,0BAA0B;IAC1B,IAAIhB,YAAY;QACdgB,YAAYN,cAAcV,YAAYM;IACxC;IAEA,6BAA6B;IAC7B,IAAIL,eAAeA,YAAYgB,MAAM,GAAG,GAAG;QACzCD,YAAYT,aACRN,YAAYiB,KAAK,CAACC,CAAAA,IAAKT,cAAcS,GAAGb,mBACxCO,iBAAiBZ;IACvB;IAEA,oBAAoB;IACpB,IAAIC,MAAM;QACRc,YAAYA,aAAaL,QAAQT;IACnC;IAEA,uBAAuB;IACvB,IAAIC,SAASA,MAAMc,MAAM,GAAG,GAAG;QAC7BD,YAAYA,aAAcT,CAAAA,aACtBJ,MAAMe,KAAK,CAACE,CAAAA,IAAKT,QAAQS,MACzBR,WAAWT,MAAK;IACtB;IAEA,wBAAwB;IACxB,IAAIC,YAAYC,QAAQ;QACtBW,YAAYA,aAAaF,UAAUV,UAAUC,QAAQC;IACvD;IAEA,OAAOU,0BAAY;kBAAGP;uBAAe;kBAAGD;;AAC1C;AAGO,SAASZ,UAAU,EAAEa,QAAQ,EAAED,WAAW,IAAI,EAA6D;IAChH,qBACE,qBAACX;QAAgBM,OAAO;YAAC;YAAS;YAAsB;SAAc;QAAEK,UAAUA;kBAC/EC;;AAGP;AAEO,SAASV,UAAU,EACxBG,IAAI,EACJC,KAAK,EACLM,QAAQ,EACRD,WAAW,IAAI,EAMhB;IACC,qBACE,qBAACX;QAAgBK,MAAMA;QAAMC,OAAOA;QAAOK,UAAUA;kBAClDC;;AAGP;AAEO,SAASX,cAAc,EAC5BM,QAAQ,EACRC,MAAM,EACNC,cAAc,EACdG,QAAQ,EACRD,WAAW,IAAI,EAOhB;IACC,qBACE,qBAACX;QAAgBO,UAAUA;QAAUC,QAAQA;QAAQC,gBAAgBA;QAAgBE,UAAUA;kBAC5FC;;AAGP"}
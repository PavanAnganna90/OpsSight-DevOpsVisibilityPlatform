{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/dashboard/CommandCenterPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { fetchLiveMetrics, fetchEvents } from '../../services/dashboardApi';\nimport { useSettings } from '../../contexts/SettingsContext';\nimport { trackEvent } from '../../utils/analytics';\nimport EmptyState from '../ui/EmptyState';\n\nexport default function CommandCenterPanel() {\n  const { panelVisibility, refreshInterval } = useSettings();\n  const {\n    data: liveMetrics,\n    isLoading: isLoadingMetrics,\n    error: errorMetrics,\n    refetch: refetchMetrics\n  } = useQuery({ queryKey: ['liveMetrics'], queryFn: fetchLiveMetrics });\n  const {\n    data: events,\n    isLoading: isLoadingEvents,\n    error: errorEvents,\n    refetch: refetchEvents\n  } = useQuery({ queryKey: ['events'], queryFn: fetchEvents });\n\n  // Hide panel if not visible\n  if (!panelVisibility.commandCenter) return null;\n\n  // Auto-refresh logic\n  useEffect(() => {\n    if (refreshInterval > 0) {\n      const interval = setInterval(() => {\n        trackEvent('auto-refresh', { panel: 'CommandCenter' });\n        refetchMetrics();\n        refetchEvents();\n      }, refreshInterval * 1000);\n      return () => clearInterval(interval);\n    }\n  }, [refreshInterval, refetchMetrics, refetchEvents]);\n\n  const handleRefresh = async () => {\n    trackEvent('refresh', { panel: 'CommandCenter' });\n    await Promise.all([refetchMetrics(), refetchEvents()]);\n  };\n\n  if (isLoadingMetrics || isLoadingEvents) {\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500 mb-2\" aria-label=\"Loading command center\" />\n        <span className=\"text-gray-500\">Loading command center...</span>\n      </section>\n    );\n  }\n\n  if (errorMetrics || errorEvents) {\n    trackEvent('error', { panel: 'CommandCenter', error: String(errorMetrics || errorEvents) });\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"Error Loading Data\"\n          description=\"We couldn't load command center data. Please try again.\"\n          action={{ label: 'Retry', onClick: handleRefresh }}\n        />\n      </section>\n    );\n  }\n\n  // Render live metrics and events\n  return (\n    <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 relative overflow-hidden min-h-[320px]\">\n      <div className=\"flex items-center justify-between mb-2\">\n        <div className=\"font-medium\">Live Metrics & Events</div>\n        <div className=\"flex items-center gap-2\">\n          {refreshInterval > 0 && (\n            <span className=\"text-xs text-blue-400\" title=\"Auto-refresh enabled\">\n              Auto-refresh: {refreshInterval}s\n            </span>\n          )}\n          <button\n            onClick={handleRefresh}\n            className=\"px-3 py-1 rounded bg-blue-500 text-white font-medium hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 transition\"\n          >\n            Refresh\n          </button>\n        </div>\n      </div>\n      {/* Live Metrics */}\n      <div className=\"flex flex-col gap-2\">\n        <div className=\"font-medium\">CPU Usage: <span className=\"text-blue-600\">{liveMetrics?.cpu ?? '--'}%</span></div>\n        <div className=\"font-medium\">Memory Usage: <span className=\"text-blue-600\">{liveMetrics?.memory ?? '--'}%</span></div>\n        <div className=\"font-medium mt-2\">Deployments</div>\n        <ul className=\"text-sm text-gray-700 dark:text-gray-200\">\n          {liveMetrics?.deployments?.length ? (\n            liveMetrics.deployments.map((d: any) => (\n              <li key={d.id}>\n                {d.service}: <span className=\"font-semibold\">{d.status}</span> <span className=\"text-xs text-gray-400\">({d.timestamp})</span>\n              </li>\n            ))\n          ) : (\n            <li>No deployments</li>\n          )}\n        </ul>\n        <div className=\"font-medium mt-2\">Active Alerts: <span className=\"text-red-600\">{liveMetrics?.alerts ?? 0}</span></div>\n      </div>\n      {/* Events Feed */}\n      <div className=\"mt-4\">\n        <div className=\"font-medium mb-1\">Events Feed</div>\n        <ul className=\"text-sm text-gray-700 dark:text-gray-200\">\n          {events?.length ? (\n            events.map((e: any) => (\n              <li key={e.id}>\n                <span className=\"font-semibold\">[{e.type}]</span> {e.message} <span className=\"text-xs text-gray-400\">({e.timestamp})</span>\n              </li>\n            ))\n          ) : (\n            <li>No events</li>\n          )}\n        </ul>\n      </div>\n    </section>\n  );\n} "],"names":["CommandCenterPanel","panelVisibility","refreshInterval","useSettings","data","liveMetrics","isLoading","isLoadingMetrics","error","errorMetrics","refetch","refetchMetrics","useQuery","queryKey","queryFn","fetchLiveMetrics","events","isLoadingEvents","errorEvents","refetchEvents","fetchEvents","commandCenter","useEffect","interval","setInterval","trackEvent","panel","clearInterval","handleRefresh","Promise","all","section","className","div","aria-label","span","String","EmptyState","illustration","title","description","action","label","onClick","button","cpu","memory","ul","deployments","length","map","d","li","service","status","timestamp","id","alerts","e","type","message"],"mappings":"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"}